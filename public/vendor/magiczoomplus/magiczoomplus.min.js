/*


   Magic Zoom Plus v5.3.7 for MagicToolbox.com
   Copyright 2022 Magic Toolbox
   Buy a license: https://www.magictoolbox.com/magiczoomplus/
   License agreement: https://www.magictoolbox.com/license/


*/

window.MagicZoom=function(){var m,e=m=function(){var e,t={version:"v3.3.6",UUID:0,storage:{},$uuid:function(t){return t.$J_UUID||(t.$J_UUID=++h.UUID)},getStorage:function(t){return h.storage[t]||(h.storage[t]={})},$F:function(){},$false:function(){return!1},$true:function(){return!0},stylesId:"mjs-"+Math.floor(Math.random()*(new Date).getTime()),defined:function(t){return null!=t},ifndef:function(t,e){return null!=t?t:e},exists:function(t){return!!t},jTypeOf:function(t){function e(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}if(!h.defined(t))return!1;if(t.$J_TYPE)return t.$J_TYPE;if(t.nodeType){if(1===t.nodeType)return"element";if(3===t.nodeType)return"textnode"}if(t===window)return"window";if(t===document)return"document";if(t instanceof window.Function)return"function";if(t instanceof window.String)return"string";if(t instanceof window.Array)return"array";if(t instanceof window.Date)return"date";if(t instanceof window.RegExp)return"regexp";if(e(t.length)&&t.item)return"collection";if(e(t.length)&&t.callee)return"arguments";if((t instanceof window.Object||t instanceof window.Function)&&t.constructor===h.Class)return"class";if(h.browser.trident){if(h.defined(t.cancelBubble))return"event"}else if(t===window.event||t.constructor===window.Event||t.constructor===window.MouseEvent||t.constructor===window.UIEvent||t.constructor===window.KeyboardEvent||t.constructor===window.KeyEvent)return"event";return typeof t},extend:function(t,e){if(t instanceof window.Array||(t=[t]),!e)return t[0];for(var i=0,o=t.length;i<o;i++)if(h.defined(t))for(var n in e)if(Object.prototype.hasOwnProperty.call(e,n))try{t[i][n]=e[n]}catch(t){}return t[0]},implement:function(t,e){t instanceof window.Array||(t=[t]);for(var i=0,o=t.length;i<o;i++)if(h.defined(t[i])&&t[i].prototype)for(var n in e||{})t[i].prototype[n]||(t[i].prototype[n]=e[n]);return t[0]},nativize:function(t,e){if(!h.defined(t))return t;for(var i in e||{})t[i]||(t[i]=e[i]);return t},$try:function(){for(var t=0,e=arguments.length;t<e;t++)try{return arguments[t]()}catch(t){}return null},$A:function(t){if(!h.defined(t))return h.$([]);if(t.toArray)return h.$(t.toArray());if(t.item){for(var e=t.length||0,i=new Array(e);e--;)i[e]=t[e];return h.$(i)}return h.$(Array.prototype.slice.call(t))},now:function(){return(new Date).getTime()},detach:function(t){var e;switch(h.jTypeOf(t)){case"object":for(var i in e={},t)e[i]=h.detach(t[i]);break;case"array":e=[];for(var o=0,n=t.length;o<n;o++)e[o]=h.detach(t[o]);break;default:return t}return h.$(e)},$:function(t){var e=!0;if(!h.defined(t))return null;if(t.$J_EXT)return t;switch(h.jTypeOf(t)){case"array":return(t=h.nativize(t,h.extend(h.Array,{$J_EXT:h.$F}))).jEach=t.forEach,t.contains=h.Array.contains,t;case"string":var i=document.getElementById(t);return h.defined(i)?h.$(i):null;case"window":case"document":h.$uuid(t),t=h.extend(t,h.Doc);break;case"element":h.$uuid(t),t=h.extend(t,h.Element);break;case"event":t=h.extend(t,h.Event);break;case"textnode":case"function":case"date":default:e=!1}return e?h.extend(t,{$J_EXT:h.$F}):t},$new:function(t,e,i){return h.$(h.doc.createElement(t)).setProps(e||{}).jSetCss(i||{})},addCSS:function(t,e,i){var o,n=[],s=-1;if(i=i||h.stylesId,o=(i=h.$(i)||h.$new("style",{id:i,type:"text/css"}).jAppendTo(document.head||document.body,"top")).sheet||i.styleSheet,"string"!==h.jTypeOf(e)){for(var a in e)n.push(a+":"+e[a]);e=n.join(";")}if(o.insertRule)s=o.insertRule(t+" {"+e+"}",o.cssRules.length);else try{s=o.addRule(t,e,o.rules.length)}catch(t){}return s},removeCSS:function(t,e){var t=h.$(t);"element"===h.jTypeOf(t)&&((t=t.sheet||t.styleSheet).deleteRule?t.deleteRule(e):t.removeRule&&t.removeRule(e))},generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"===t?e:3&e|8).toString(16)}).toUpperCase()},getAbsoluteURL:function(t){return(e=e||document.createElement("a")).setAttribute("href",t),("!!"+e.href).replace("!!","")},getHashCode:function(t){for(var e=0,i=t.length,o=0;o<i;++o)e=31*e+t.charCodeAt(o),e%=4294967296;return e}},h=t;t.$;window.magicJS||(window.magicJS=t,window.$mjs=t.$),h.Array={$J_TYPE:"array",indexOf:function(t,e){this.length;for(var i=this.length,o=e<0?Math.max(0,i+e):e||0;o<i;o++)if(this[o]===t)return o;return-1},contains:function(t,e){return-1!=this.indexOf(t,e)},forEach:function(t,e){for(var i=0,o=this.length;i<o;i++)i in this&&t.call(e,this[i],i,this)},filter:function(t,e){for(var i,o=[],n=0,s=this.length;n<s;n++)n in this&&(i=this[n],t.call(e,this[n],n,this)&&o.push(i));return o},map:function(t,e){for(var i=[],o=0,n=this.length;o<n;o++)o in this&&(i[o]=t.call(e,this[o],o,this));return i}},h.implement(String,{$J_TYPE:"string",jTrim:function(){return this.replace(/^\s+|\s+$/g,"")},eq:function(t,e){return e?this.toString()===t.toString():this.toLowerCase().toString()===t.toLowerCase().toString()},jCamelize:function(){return this.replace(/-\D/g,function(t){return t.charAt(1).toUpperCase()})},dashize:function(){return this.replace(/[A-Z]/g,function(t){return"-"+t.charAt(0).toLowerCase()})},jToInt:function(t){return parseInt(this,t||10)},toFloat:function(){return parseFloat(this)},jToBool:function(){return!this.replace(/true/i,"").jTrim()},has:function(t,e){return-1<((e=e||"")+this+e).indexOf(e+t+e)}}),t.implement(Function,{$J_TYPE:"function",jBind:function(){var t=h.$A(arguments),e=this,i=t.shift();return function(){return e.apply(i||null,t.concat(h.$A(arguments)))}},jBindAsEvent:function(){var e=h.$A(arguments),i=this,o=e.shift();return function(t){return i.apply(o||null,h.$([t||(h.browser.ieMode?window.event:null)]).concat(e))}},jDelay:function(){var t=h.$A(arguments),e=this,i=t.shift();return window.setTimeout(function(){return e.apply(e,t)},i||0)},jDefer:function(){var t=h.$A(arguments),e=this;return function(){return e.jDelay.apply(e,t)}},interval:function(){var t=h.$A(arguments),e=this,i=t.shift();return window.setInterval(function(){return e.apply(e,t)},i||0)}});var r={},i=navigator.userAgent.toLowerCase(),o=i.match(/(webkit|gecko|trident|presto)\/(\d+\.?\d*)/i),n=i.match(/(edge|opr)\/(\d+\.?\d*)/i)||i.match(/(crios|chrome|safari|firefox|opera|opr)\/(\d+\.?\d*)/i),s=i.match(/version\/(\d+\.?\d*)/i),a=document.documentElement.style;function d(t){var e=t.charAt(0).toUpperCase()+t.slice(1);return t in a||"Webkit"+e in a||"Moz"+e in a||"ms"+e in a||"O"+e in a}h.browser={features:{xpath:!!document.evaluate,air:!!window.runtime,query:!!document.querySelector,fullScreen:!!(document.fullscreenEnabled||document.msFullscreenEnabled||document.exitFullscreen||document.cancelFullScreen||document.webkitexitFullscreen||document.webkitCancelFullScreen||document.mozCancelFullScreen||document.oCancelFullScreen||document.msCancelFullScreen),xhr2:!!window.ProgressEvent&&!!window.FormData&&window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest,transition:d("transition"),transform:d("transform"),perspective:d("perspective"),animation:d("animation"),requestAnimationFrame:!1,multibackground:!1,cssFilters:!1,canvas:!1,svg:document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")},touchScreen:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints,mobile:!!i.match(/(android|bb\d+|meego).+|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od|ad)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/),engine:o&&o[1]?o[1].toLowerCase():window.opera?"presto":window.ActiveXObject?"trident":void 0!==document.getBoxObjectFor||null!==window.mozInnerScreenY?"gecko":null===window.WebKitPoint&&navigator.taintEnabled?"unknown":"webkit",version:o&&o[2]?parseFloat(o[2]):0,uaName:n&&n[1]?n[1].toLowerCase():"",uaVersion:n&&n[2]?parseFloat(n[2]):0,cssPrefix:"",cssDomPrefix:"",domPrefix:"",ieMode:0,platform:i.match(/ip(?:ad|od|hone)/)?"ios":(i.match(/(?:webos|android)/)||navigator.platform.match(/mac|win|linux/i)||["other"])[0].toLowerCase(),backCompat:document.compatMode&&"backcompat"===document.compatMode.toLowerCase(),scrollbarsWidth:0,getDoc:function(){return document.compatMode&&"backcompat"===document.compatMode.toLowerCase()?document.body:document.documentElement},requestAnimationFrame:window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||void 0,cancelAnimationFrame:window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.mozCancelAnimationFrame||window.oCancelAnimationFrame||window.msCancelAnimationFrame||window.webkitCancelRequestAnimationFrame||void 0,ready:!1,onready:function(){if(!h.browser.ready){var t,e,i;h.browser.ready=!0,h.body=h.$(document.body),h.win=h.$(window);try{var o=h.$new("div").jSetCss({width:100,height:100,overflow:"scroll",position:"absolute",top:-9999}).jAppendTo(document.body);h.browser.scrollbarsWidth=o.offsetWidth-o.clientWidth,o.jRemove()}catch(t){}try{(e=(t=h.$new("div")).style).cssText="background:url(https://),url(https://),red url(https://)",h.browser.features.multibackground=/(url\s*\(.*?){3}/.test(e.background),t=e=null}catch(t){}h.browser.cssTransformProp||(h.browser.cssTransformProp=h.normalizeCSS("transform").dashize());try{(t=h.$new("div")).style.cssText=h.normalizeCSS("filter").dashize()+":blur(2px);",h.browser.features.cssFilters=!!t.style.length&&(!h.browser.ieMode||9<h.browser.ieMode),t=null}catch(t){}h.browser.features.cssFilters||h.$(document.documentElement).jAddClass("no-cssfilters-magic");try{h.browser.features.canvas=!(!(i=h.$new("canvas")).getContext||!i.getContext("2d"))}catch(t){}void 0===window.TransitionEvent&&void 0!==window.WebKitTransitionEvent&&(r.transitionend="webkitTransitionEnd"),h.Doc.jCallEvent.call(h.$(document),"domready")}}},function(){var t,e,i=[];switch(h.browser.engine){case"trident":h.browser.version||(h.browser.version=window.XMLHttpRequest?3:2);break;case"gecko":h.browser.version=n&&n[2]?parseFloat(n[2]):0}if(h.browser[h.browser.engine]=!0,n&&"crios"===n[1]&&(h.browser.uaName="chrome"),window.chrome&&(h.browser.chrome=!0),n&&"opr"===n[1]&&(h.browser.uaName="opera",h.browser.opera=!0),"safari"===h.browser.uaName&&s&&s[1]&&(h.browser.uaVersion=parseFloat(s[1])),"android"===h.browser.platform&&h.browser.webkit&&s&&s[1]&&(h.browser.androidBrowser=!0),e={gecko:["-moz-","Moz","moz"],webkit:["-webkit-","Webkit","webkit"],trident:["-ms-","ms","ms"],presto:["-o-","O","o"]}[h.browser.engine]||["","",""],h.browser.cssPrefix=e[0],h.browser.cssDomPrefix=e[1],h.browser.domPrefix=e[2],h.browser.ieMode=h.browser.trident?document.documentMode||function(){var t=0;if(h.browser.backCompat)return 5;switch(h.browser.version){case 2:t=6;break;case 3:t=7}return t}():void 0,!h.browser.mobile&&"mac"===h.browser.platform&&h.browser.touchScreen&&(h.browser.mobile=!0,h.browser.platform="ios"),i.push(h.browser.platform+"-magic"),h.browser.mobile&&i.push("mobile-magic"),h.browser.androidBrowser&&i.push("android-browser-magic"),h.browser.ieMode)for(h.browser.uaName="ie",h.browser.uaVersion=h.browser.ieMode,i.push("ie"+h.browser.ieMode+"-magic"),t=11;t>h.browser.ieMode;t--)i.push("lt-ie"+t+"-magic");h.browser.webkit&&h.browser.version<536&&(h.browser.features.fullScreen=!1),h.browser.requestAnimationFrame&&h.browser.requestAnimationFrame.call(window,function(){h.browser.features.requestAnimationFrame=!0}),h.browser.features.svg?i.push("svg-magic"):i.push("no-svg-magic"),e=(document.documentElement.className||"").match(/\S+/g)||[],document.documentElement.className=h.$(e).concat(i).join(" ");try{document.documentElement.setAttribute("data-magic-ua",h.browser.uaName),document.documentElement.setAttribute("data-magic-ua-ver",h.browser.uaVersion),document.documentElement.setAttribute("data-magic-engine",h.browser.engine),document.documentElement.setAttribute("data-magic-engine-ver",h.browser.version)}catch(t){}h.browser.ieMode&&h.browser.ieMode<9&&(document.createElement("figure"),document.createElement("figcaption")),window.navigator.pointerEnabled||h.$(["Down","Up","Move","Over","Out"]).jEach(function(t){r["pointer"+t.toLowerCase()]=window.navigator.msPointerEnabled?"MSPointer"+t:-1})}(),h.browser.fullScreen={capable:h.browser.features.fullScreen,enabled:function(){return!!(document.fullscreenElement||document[h.browser.domPrefix+"FullscreenElement"]||document.fullScreen||document.webkitIsFullScreen||document[h.browser.domPrefix+"FullScreen"])},request:function(t,e){e=e||{},this.capable?(h.$(document).jAddEvent(this.changeEventName,this.onchange=function(t){this.enabled()?e.onEnter&&e.onEnter():(h.$(document).jRemoveEvent(this.changeEventName,this.onchange),e.onExit&&e.onExit())}.jBindAsEvent(this)),h.$(document).jAddEvent(this.errorEventName,this.onerror=function(t){e.fallback&&e.fallback(),h.$(document).jRemoveEvent(this.errorEventName,this.onerror)}.jBindAsEvent(this)),(t.requestFullscreen||t[h.browser.domPrefix+"RequestFullscreen"]||t[h.browser.domPrefix+"RequestFullScreen"]||function(){}).call(t)):e.fallback&&e.fallback()},cancel:(document.exitFullscreen||document.cancelFullScreen||document[h.browser.domPrefix+"ExitFullscreen"]||document[h.browser.domPrefix+"CancelFullScreen"]||function(){}).jBind(document),changeEventName:document.msExitFullscreen?"MSFullscreenChange":(document.exitFullscreen?"":h.browser.domPrefix)+"fullscreenchange",errorEventName:document.msExitFullscreen?"MSFullscreenError":(document.exitFullscreen?"":h.browser.domPrefix)+"fullscreenerror",prefix:h.browser.domPrefix,activeElement:null};var l,m,c,u,p,g,v,f,x,w,z,b,j,y,C=/\S+/g,S=/^(border(Top|Bottom|Left|Right)Width)|((padding|margin)(Top|Bottom|Left|Right))$/,E={float:void 0===a.styleFloat?"cssFloat":"styleFloat"},B={fontWeight:!0,lineHeight:!0,opacity:!0,zIndex:!0,zoom:!0},T=window.getComputedStyle?function(t,e){t=window.getComputedStyle(t,null);return t?t.getPropertyValue(e)||t[e]:null}:function(t,e){var i=t.currentStyle,o=null;return null==(o=i?i[e]:null)&&t.style&&t.style[e]&&(o=t.style[e]),o};function A(t){var e;return!((!h.browser.webkit||"filter"!=t)&&t in a)&&(e=h.browser.cssDomPrefix+t.charAt(0).toUpperCase()+t.slice(1))in a?e:t}function M(t,e){var i=e.x-t.x,t=e.y-t.y;return Math.sqrt(i*i+t*t)}function k(t,e){var i;return t.targetTouches&&t.changedTouches?(i=t.targetTouches||t.changedTouches,i=Array.prototype.slice.call(i)):(i=[],e&&e.forEach(function(t){i.push(t)})),i}function O(t,e,i){var o=!1;return!t.pointerId||"touch"!==t.pointerType||i&&!e.has(t.pointerId)||(e.set(t.pointerId,t),o=!0),o}function R(t){t=t.pointerId&&"touch"===t.pointerType?t.pointerId:t.identifier;return t}function $(t,e){for(var i,o=!1,n=0;n<t.length&&2!==e.length;n++)i=R(t[n]),e.contains(i)||(e.push(i),o=!0);return o}function I(t,e){var i,o,n,s=!1;if(e)for(t=t,n=w([]),t.forEach(function(t){n.push(R(t))}),o=n,i=0;i<e.length;i++)if(!o.contains(e[i])){e.splice(i,1),s=!0;break}return s}function F(t,e){for(var i=w([]),o=0;o<t.length&&(!e.contains(R(t[o]))||(i.push(t[o]),2!==i.length));o++);return i}function P(){j=null}return h.normalizeCSS=A,h.Element={jHasClass:function(t){return!(t||"").has(" ")&&(this.className||"").has(t," ")},jAddClass:function(t){for(var e=(this.className||"").match(C)||[],i=(t||"").match(C)||[],o=i.length,n=0;n<o;n++)h.$(e).contains(i[n])||e.push(i[n]);return this.className=e.join(" "),this},jRemoveClass:function(t){for(var e,i=(this.className||"").match(C)||[],o=(t||"").match(C)||[],n=o.length,s=0;s<n;s++)-1<(e=h.$(i).indexOf(o[s]))&&i.splice(e,1);return this.className=t?i.join(" "):"",this},jToggleClass:function(t){return this.jHasClass(t)?this.jRemoveClass(t):this.jAddClass(t)},jGetCss:function(t){var e=t.jCamelize(),i=null;if(t=E[e]||(E[e]=A(e)),"auto"===(i=T(this,t))&&(i=null),null!==i){if("opacity"==t)return h.defined(i)?parseFloat(i):1;S.test(t)&&(i=parseInt(i,10)?i:"0px")}return i},jSetCssProp:function(t,e){var i=t.jCamelize();try{if("opacity"==t)return this.jSetOpacity(e),this;t=E[i]||(E[i]=A(i)),this.style[t]=e+("number"!=h.jTypeOf(e)||B[i]?"":"px")}catch(t){}return this},jSetCss:function(t){for(var e in t)this.jSetCssProp(e,t[e]);return this},jGetStyles:function(){var e={};return h.$A(arguments).jEach(function(t){e[t]=this.jGetCss(t)},this),e},jSetOpacity:function(t,e){return e=e||!1,this.style.opacity=t,t=parseInt(100*parseFloat(t)),e&&(0===t?"hidden"!=this.style.visibility&&(this.style.visibility="hidden"):"visible"!=this.style.visibility&&(this.style.visibility="visible")),h.browser.ieMode&&h.browser.ieMode<9&&(isNaN(t)?(this.style.filter=this.style.filter.replace(/progid:DXImageTransform.Microsoft.Alpha\(Opacity=\d*\)/i,"").jTrim(),""===this.style.filter&&this.style.removeAttribute("filter")):~this.style.filter.indexOf("Alpha")?this.style.filter=this.style.filter.replace(/Opacity=\d*/i,"Opacity="+t):this.style.filter+=" progid:DXImageTransform.Microsoft.Alpha(Opacity="+t+")"),this},setProps:function(t){for(var e in t)"class"===e?this.jAddClass(""+t[e]):this.setAttribute(e,""+t[e]);return this},jGetTransitionDuration:function(){var t=0,e=0,t=this.jGetCss("transition-duration"),e=this.jGetCss("transition-delay");return(t=-1<t.indexOf("ms")?parseFloat(t):-1<t.indexOf("s")?1e3*parseFloat(t):0)+(e=-1<e.indexOf("ms")?parseFloat(e):-1<e.indexOf("s")?1e3*parseFloat(e):0)},hide:function(){return this.jSetCss({display:"none",visibility:"hidden"})},show:function(){return this.jSetCss({display:"",visibility:"visible"})},jGetSize:function(){return{width:this.offsetWidth,height:this.offsetHeight}},getInnerSize:function(t){var e=this.jGetSize();return e.width-=parseFloat(this.jGetCss("border-left-width")||0)+parseFloat(this.jGetCss("border-right-width")||0),e.height-=parseFloat(this.jGetCss("border-top-width")||0)+parseFloat(this.jGetCss("border-bottom-width")||0),t||(e.width-=parseFloat(this.jGetCss("padding-left")||0)+parseFloat(this.jGetCss("padding-right")||0),e.height-=parseFloat(this.jGetCss("padding-top")||0)+parseFloat(this.jGetCss("padding-bottom")||0)),e},jGetScroll:function(){return{top:this.scrollTop,left:this.scrollLeft}},jGetFullScroll:function(){for(var t=this,e={top:0,left:0};e.left+=t.scrollLeft||0,e.top+=t.scrollTop||0,t=t.parentNode,t;);return e},jGetPosition:function(){var t=this,e=0,i=0;if(h.defined(document.documentElement.getBoundingClientRect)){var o=this.getBoundingClientRect(),n=h.$(document).jGetScroll(),s=h.browser.getDoc();return{top:o.top+n.y-s.clientTop,left:o.left+n.x-s.clientLeft}}for(;e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.offsetParent,t&&!/^(?:body|html)$/i.test(t.tagName););return{top:i,left:e}},jGetOffset:function(){for(var t=this,e=0,i=0;e+=t.offsetLeft||0,i+=t.offsetTop||0,t=t.offsetParent,t&&!/^(?:body|html)$/i.test(t.tagName););return{top:i,left:e}},jGetRect:function(){var t=this.jGetPosition(),e=this.jGetSize();return{top:t.top,bottom:t.top+e.height,left:t.left,right:t.left+e.width}},changeContent:function(e){try{this.innerHTML=e}catch(t){this.innerText=e}return this},jRemove:function(){return this.parentNode?this.parentNode.removeChild(this):this},kill:function(){return h.$A(this.childNodes).jEach(function(t){3!=t.nodeType&&8!=t.nodeType&&h.$(t).kill()}),this.jRemove(),this.jClearEvents(),this.$J_UUID&&(h.storage[this.$J_UUID]=null,delete h.storage[this.$J_UUID]),null},append:function(t,e){e=e||"bottom";var i=this.firstChild;return"top"==e&&i?this.insertBefore(t,i):this.appendChild(t),this},jAppendTo:function(t,e){h.$(t).append(this,e);return this},enclose:function(t){return this.append(t.parentNode.replaceChild(this,t)),this},hasChild:function(t){return"element"===h.jTypeOf("string"==h.jTypeOf(t)?t=document.getElementById(t):t)&&(this!=t&&(this.contains&&!h.browser.webkit419?this.contains(t):this.compareDocumentPosition?!!(16&this.compareDocumentPosition(t)):h.$A(this.byTag(t.tagName)).contains(t)))}},h.Element.jGetStyle=h.Element.jGetCss,h.Element.jSetStyle=h.Element.jSetCss,window.Element||(window.Element=h.$F,h.browser.engine.webkit&&window.document.createElement("iframe"),window.Element.prototype=h.browser.engine.webkit?window["[[DOMElement.prototype]]"]:{}),h.implement(window.Element,{$J_TYPE:"element"}),h.Doc={jGetSize:function(){return h.browser.touchScreen||h.browser.presto925||h.browser.webkit419?{width:window.innerWidth,height:window.innerHeight}:{width:h.browser.getDoc().clientWidth,height:h.browser.getDoc().clientHeight}},jGetScroll:function(){return{x:window.pageXOffset||h.browser.getDoc().scrollLeft,y:window.pageYOffset||h.browser.getDoc().scrollTop}},jGetFullSize:function(){var t=this.jGetSize();return{width:Math.max(h.browser.getDoc().scrollWidth,t.width),height:Math.max(h.browser.getDoc().scrollHeight,t.height)}}},h.extend(document,{$J_TYPE:"document"}),h.extend(window,{$J_TYPE:"window"}),h.extend([h.Element,h.Doc],{jFetch:function(t,e){var i=h.getStorage(this.$J_UUID),o=i[t];return void 0!==e&&void 0===o&&(o=i[t]=e),h.defined(o)?o:null},jStore:function(t,e){return h.getStorage(this.$J_UUID)[t]=e,this},jDel:function(t){return delete h.getStorage(this.$J_UUID)[t],this}}),window.HTMLElement&&window.HTMLElement.prototype&&window.HTMLElement.prototype.getElementsByClassName||h.extend([h.Element,h.Doc],{getElementsByClassName:function(e){return h.$A(this.getElementsByTagName("*")).filter(function(t){try{return 1==t.nodeType&&t.className.has(e," ")}catch(t){}})}}),h.extend([h.Element,h.Doc],{byClass:function(){return this.getElementsByClassName(arguments[0])},byTag:function(){return this.getElementsByTagName(arguments[0])}}),h.browser.fullScreen.capable&&!document.requestFullScreen&&(h.Element.requestFullScreen=function(){h.browser.fullScreen.request(this)}),h.Event={$J_TYPE:"event",isQueueStopped:h.$false,stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.stopPropagation?this.stopPropagation():this.cancelBubble=!0,this},stopDefaults:function(){return this.preventDefault?this.preventDefault():this.returnValue=!1,this},stopQueue:function(){return this.isQueueStopped=h.$true,this},getClientXY:function(){var t=/touch/i.test(this.type)?this.changedTouches[0]:this;return h.defined(t)?{x:t.clientX,y:t.clientY}:{x:0,y:0}},jGetPageXY:function(){var t=/touch/i.test(this.type)?this.changedTouches[0]:this;return h.defined(t)?{x:t.pageX||t.clientX+h.browser.getDoc().scrollLeft,y:t.pageY||t.clientY+h.browser.getDoc().scrollTop}:{x:0,y:0}},getTarget:function(){for(var t=this.target||this.srcElement;t&&3===t.nodeType;)t=t.parentNode;return t},getRelated:function(){var e=null;switch(this.type){case"mouseover":case"pointerover":case"MSPointerOver":e=this.relatedTarget||this.fromElement;break;case"mouseout":case"pointerout":case"MSPointerOut":e=this.relatedTarget||this.toElement;break;default:return e}try{for(;e&&3===e.nodeType;)e=e.parentNode}catch(t){e=null}return e},getButton:function(){return this.which||void 0===this.button?this.which:1&this.button?1:2&this.button?3:4&this.button?2:0},isTouchEvent:function(){return this.pointerType&&("touch"===this.pointerType||this.pointerType===this.MSPOINTER_TYPE_TOUCH)||/touch/i.test(this.type)},isPrimaryTouch:function(){return this.pointerType?("touch"===this.pointerType||this.MSPOINTER_TYPE_TOUCH===this.pointerType)&&this.isPrimary:this instanceof window.TouchEvent&&(1===this.changedTouches.length&&(!this.targetTouches.length||1===this.targetTouches.length&&this.targetTouches[0].identifier===this.changedTouches[0].identifier))},getPrimaryTouch:function(){return this.pointerType?!this.isPrimary||"touch"!==this.pointerType&&this.MSPOINTER_TYPE_TOUCH!==this.pointerType?null:this:this instanceof window.TouchEvent?this.changedTouches[0]:null},getPrimaryTouchId:function(){return this.pointerType?!this.isPrimary||"touch"!==this.pointerType&&this.MSPOINTER_TYPE_TOUCH!==this.pointerType?null:this.pointerId:this instanceof window.TouchEvent?this.changedTouches[0].identifier:null}},h._event_add_="addEventListener",h._event_del_="removeEventListener",h._event_prefix_="",document.addEventListener||(h._event_add_="attachEvent",h._event_del_="detachEvent",h._event_prefix_="on"),h.Event.Custom={type:"",x:null,y:null,timeStamp:null,button:null,target:null,relatedTarget:null,$J_TYPE:"event.custom",isQueueStopped:h.$false,events:h.$([]),pushToEvents:function(t){this.events.push(t)},stop:function(){return this.stopDistribution().stopDefaults()},stopDistribution:function(){return this.events.jEach(function(t){try{t.stopDistribution()}catch(t){}}),this},stopDefaults:function(){return this.events.jEach(function(t){try{t.stopDefaults()}catch(t){}}),this},stopQueue:function(){return this.isQueueStopped=h.$true,this},getClientXY:function(){return{x:this.clientX,y:this.clientY}},jGetPageXY:function(){return{x:this.x,y:this.y}},getTarget:function(){return this.target},getRelated:function(){return this.relatedTarget},getButton:function(){return this.button},getOriginalTarget:function(){return 0<this.events.length?this.events[0].getTarget():void 0},isTouchEvent:function(){return this.pointerType&&("touch"===this.pointerType||this.pointerType===this.MSPOINTER_TYPE_TOUCH)||/touch/i.test(this.type)},isPrimaryTouch:function(){return this.pointerType?("touch"===this.pointerType||this.MSPOINTER_TYPE_TOUCH===this.pointerType)&&this.isPrimary:this instanceof window.TouchEvent&&(1===this.changedTouches.length&&(!this.targetTouches.length||this.targetTouches[0].identifier===this.changedTouches[0].identifier))},getPrimaryTouch:function(){return this.pointerType?!this.isPrimary||"touch"!==this.pointerType&&this.MSPOINTER_TYPE_TOUCH!==this.pointerType?null:this:this instanceof window.TouchEvent?this.changedTouches[0]:null},getPrimaryTouchId:function(){return this.pointerType?!this.isPrimary||"touch"!==this.pointerType&&this.MSPOINTER_TYPE_TOUCH!==this.pointerType?null:this.pointerId:this instanceof window.TouchEvent?this.changedTouches[0].identifier:null}},h.extend([h.Element,h.Doc],{jAddEvent:function(e,t,i,o){var n,s,a;return"string"===h.jTypeOf(e)&&1<(a=e.split(" ")).length&&(e=a),"array"===h.jTypeOf(e)?h.$(e).jEach(this.jAddEvent.jBindAsEvent(this,t,i,o)):(e=r[e]||e)&&t&&"string"===h.jTypeOf(e)&&"function"===h.jTypeOf(t)&&("domready"===e&&h.browser.ready?t.call(this):(i=parseInt(i||50,10),t.$J_EUID||(t.$J_EUID=Math.floor(Math.random()*h.now())),(a=(n=h.Doc.jFetch.call(this,"_EVENTS_",{}))[e])||(n[e]=a=h.$([]),s=this,h.Event.Custom[e]?h.Event.Custom[e].handler.add.call(this,o):(a.handle=function(t){t=h.extend(t||window.e,{$J_TYPE:"event"}),h.Doc.jCallEvent.call(s,e,h.$(t))},this[h._event_add_](h._event_prefix_+e,a.handle,!1))),t={type:e,fn:t,priority:i,euid:t.$J_EUID},a.push(t),a.sort(function(t,e){return t.priority-e.priority}))),this},jRemoveEvent:function(t){var e,i,o,n,s=h.Doc.jFetch.call(this,"_EVENTS_",{}),a=1<arguments.length?arguments[1]:-100;if("string"===h.jTypeOf(t)&&1<(n=t.split(" ")).length&&(t=n),"array"===h.jTypeOf(t))return h.$(t).jEach(this.jRemoveEvent.jBindAsEvent(this,a)),this;if(!(t=r[t]||t)||"string"!==h.jTypeOf(t)||!s||!s[t])return this;for(e=s[t]||[],o=0;o<e.length;o++)i=e[o],(-100===a||a&&a.$J_EUID===i.euid)&&e.splice(o--,1);return 0===e.length&&(h.Event.Custom[t]?h.Event.Custom[t].handler.jRemove.call(this):this[h._event_del_](h._event_prefix_+t,e.handle,!1),delete s[t]),this},jCallEvent:function(t,e){var i,o,n=h.Doc.jFetch.call(this,"_EVENTS_",{});if(!(t=r[t]||t)||"string"!==h.jTypeOf(t)||!n||!n[t])return this;try{e=h.extend(e||{},{type:t})}catch(t){}for(void 0===e.timeStamp&&(e.timeStamp=h.now()),i=n[t]||[],o=0;o<i.length&&(!e.isQueueStopped||!e.isQueueStopped());o++)i[o].fn.call(this,e)},jRaiseEvent:function(t,e){var i,o="domready"!==t,n=this;return t=r[t]||t,o?(n===document&&document.createEvent&&!n.dispatchEvent&&(n=document.documentElement),document.createEvent?(i=document.createEvent(t)).initEvent(e,!0,!0):(i=document.createEventObject()).eventType=t,document.createEvent?n.dispatchEvent(i):n.fireEvent("on"+e,i),i):(h.Doc.jCallEvent.call(this,t),this)},jClearEvents:function(){var t,e=h.Doc.jFetch.call(this,"_EVENTS_");if(!e)return this;for(t in e)h.Doc.jRemoveEvent.call(this,t);return h.Doc.jDel.call(this,"_EVENTS_"),this}}),l=t,"complete"===document.readyState?l.browser.onready.jDelay(1):l.browser.webkit&&l.browser.version<420?function(){l.$(["loaded","complete"]).contains(document.readyState)?l.browser.onready():arguments.callee.jDelay(50)}():l.browser.trident&&l.browser.ieMode<9&&window===top?function(){l.$try(function(){return l.browser.getDoc().doScroll("left"),!0})?l.browser.onready():arguments.callee.jDelay(50)}():(l.Doc.jAddEvent.call(l.$(document),"DOMContentLoaded",l.browser.onready),l.Doc.jAddEvent.call(l.$(window),"load",l.browser.onready)),h.Class=function(){var t=null,e=h.$A(arguments);"class"==h.jTypeOf(e[0])&&(t=e.shift());function i(){for(var t in this)this[t]=h.detach(this[t]);if(this.constructor.$parent){this.$parent={};var e,i=this.constructor.$parent;for(e in i){var o=i[e];switch(h.jTypeOf(o)){case"function":this.$parent[e]=h.Class.wrap(this,o);break;case"object":case"array":this.$parent[e]=h.detach(o)}}}var n=this.init?this.init.apply(this,arguments):this;return delete this.caller,n}if(i.prototype.init||(i.prototype.init=h.$F),t){function o(){}for(var n in o.prototype=t.prototype,i.prototype=new o,i.$parent={},t.prototype)i.$parent[n]=t.prototype[n]}else i.$parent=null;return i.constructor=h.Class,i.prototype.constructor=i,h.extend(i.prototype,e[0]),h.extend(i,{$J_TYPE:"class"}),i},t.Class.wrap=function(t,e){return function(){this.caller;return e.apply(t,arguments)}},(m=t).$,m.Event.Custom.btnclick=new m.Class(m.extend(m.Event.Custom,{type:"btnclick",init:function(t,e){var i=e.jGetPageXY();this.x=i.x,this.y=i.y,this.clientX=e.clientX,this.clientY=e.clientY,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e)}})),m.Event.Custom.btnclick.handler={options:{threshold:300,button:1},add:function(t){this.jStore("event:btnclick:options",m.extend(m.detach(m.Event.Custom.btnclick.handler.options),t||{})),this.jAddEvent("mousedown",m.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("mouseup",m.Event.Custom.btnclick.handler.handle,1),this.jAddEvent("click",m.Event.Custom.btnclick.handler.onclick,1),m.browser.trident&&m.browser.ieMode<9&&this.jAddEvent("dblclick",m.Event.Custom.btnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("mousedown",m.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("mouseup",m.Event.Custom.btnclick.handler.handle),this.jRemoveEvent("click",m.Event.Custom.btnclick.handler.onclick),m.browser.trident&&m.browser.ieMode<9&&this.jRemoveEvent("dblclick",m.Event.Custom.btnclick.handler.handle)},onclick:function(t){t.stopDefaults()},handle:function(t){var e,i,o=this.jFetch("event:btnclick:options");"dblclick"!=t.type&&t.getButton()!=o.button||(this.jFetch("event:btnclick:ignore")?this.jDel("event:btnclick:ignore"):"mousedown"==t.type?(e=new m.Event.Custom.btnclick(this,t),this.jStore("event:btnclick:btnclickEvent",e)):"mouseup"==t.type?(e=this.jFetch("event:btnclick:btnclickEvent"))&&(i=t.jGetPageXY(),this.jDel("event:btnclick:btnclickEvent"),e.pushToEvents(t),t.timeStamp-e.timeStamp<=o.threshold&&Math.sqrt(Math.pow(i.x-e.x,2)+Math.pow(i.y-e.y,2))<=5&&this.jCallEvent("btnclick",e),document.jCallEvent("mouseup",t)):"dblclick"==t.type&&(e=new m.Event.Custom.btnclick(this,t),this.jCallEvent("btnclick",e)))}},u=(c=t).$,c.Event.Custom.mousedrag=new c.Class(c.extend(c.Event.Custom,{type:"mousedrag",state:"dragstart",dragged:!1,init:function(t,e,i){var o=e.jGetPageXY();this.x=o.x,this.y=o.y,this.clientX=e.clientX,this.clientY=e.clientY,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e),this.state=i}})),c.Event.Custom.mousedrag.handler={add:function(){var t=c.Event.Custom.mousedrag.handler.handleMouseMove.jBindAsEvent(this),e=c.Event.Custom.mousedrag.handler.handleMouseUp.jBindAsEvent(this);this.jAddEvent("mousedown",c.Event.Custom.mousedrag.handler.handleMouseDown,1),this.jAddEvent("mouseup",c.Event.Custom.mousedrag.handler.handleMouseUp,1),document.jAddEvent("mousemove",t,1),document.jAddEvent("mouseup",e,1),this.jStore("event:mousedrag:listeners:document:move",t),this.jStore("event:mousedrag:listeners:document:end",e)},jRemove:function(){this.jRemoveEvent("mousedown",c.Event.Custom.mousedrag.handler.handleMouseDown),this.jRemoveEvent("mouseup",c.Event.Custom.mousedrag.handler.handleMouseUp),u(document).jRemoveEvent("mousemove",this.jFetch("event:mousedrag:listeners:document:move")||c.$F),u(document).jRemoveEvent("mouseup",this.jFetch("event:mousedrag:listeners:document:end")||c.$F),this.jDel("event:mousedrag:listeners:document:move"),this.jDel("event:mousedrag:listeners:document:end")},handleMouseDown:function(t){1===t.getButton()&&(t=new c.Event.Custom.mousedrag(this,t,"dragstart"),this.jStore("event:mousedrag:dragstart",t))},handleMouseUp:function(t){var e=this.jFetch("event:mousedrag:dragstart");e&&(e.dragged&&t.stopDefaults(),e=new c.Event.Custom.mousedrag(this,t,"dragend"),this.jDel("event:mousedrag:dragstart"),this.jCallEvent("mousedrag",e))},handleMouseMove:function(t){var e=this.jFetch("event:mousedrag:dragstart");e&&(t.stopDefaults(),e.dragged||(e.dragged=!0,this.jCallEvent("mousedrag",e)),e=new c.Event.Custom.mousedrag(this,t,"dragmove"),this.jCallEvent("mousedrag",e))}},(p=t).$,p.Event.Custom.dblbtnclick=new p.Class(p.extend(p.Event.Custom,{type:"dblbtnclick",timedout:!1,tm:null,init:function(t,e){var i=e.jGetPageXY();this.x=i.x,this.y=i.y,this.clientX=e.clientX,this.clientY=e.clientY,this.timeStamp=e.timeStamp,this.button=e.getButton(),this.target=t,this.pushToEvents(e)}})),p.Event.Custom.dblbtnclick.handler={options:{threshold:200},add:function(t){this.jStore("event:dblbtnclick:options",p.extend(p.detach(p.Event.Custom.dblbtnclick.handler.options),t||{})),this.jAddEvent("btnclick",p.Event.Custom.dblbtnclick.handler.handle,1)},jRemove:function(){this.jRemoveEvent("btnclick",p.Event.Custom.dblbtnclick.handler.handle)},handle:function(t){var e=this.jFetch("event:dblbtnclick:event"),i=this.jFetch("event:dblbtnclick:options");e?(clearTimeout(e.tm),this.jDel("event:dblbtnclick:event"),e.timedout||(e.pushToEvents(t),t.stopQueue().stop(),this.jCallEvent("dblbtnclick",e))):((e=new p.Event.Custom.dblbtnclick(this,t)).tm=setTimeout(function(){e.timedout=!0,t.isQueueStopped=p.$false,this.jCallEvent("btnclick",t),this.jDel("event:dblbtnclick:event")}.jBind(this),i.threshold+10),this.jStore("event:dblbtnclick:event",e),t.stopQueue())}},(g=t).$,g.Event.Custom.tap=new g.Class(g.extend(g.Event.Custom,{type:"tap",id:null,init:function(t,e){var i=e.getPrimaryTouch();this.id=i.pointerId||i.identifier,this.x=i.pageX,this.y=i.pageY,this.pageX=i.pageX,this.pageY=i.pageY,this.clientX=i.clientX,this.clientY=i.clientY,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e)}})),g.Event.Custom.tap.handler={add:function(t){this.jAddEvent(["touchstart","pointerdown"],g.Event.Custom.tap.handler.onTouchStart,1),this.jAddEvent(["touchend","pointerup"],g.Event.Custom.tap.handler.onTouchEnd,1),this.jAddEvent("click",g.Event.Custom.tap.handler.onClick,1)},jRemove:function(){this.jRemoveEvent(["touchstart","pointerdown"],g.Event.Custom.tap.handler.onTouchStart),this.jRemoveEvent(["touchend","pointerup"],g.Event.Custom.tap.handler.onTouchEnd),this.jRemoveEvent("click",g.Event.Custom.tap.handler.onClick)},onClick:function(t){t.stopDefaults()},onTouchStart:function(t){t.isPrimaryTouch()?(this.jStore("event:tap:event",new g.Event.Custom.tap(this,t)),this.jStore("event:btnclick:ignore",!0)):this.jDel("event:tap:event")},onTouchEnd:function(t){g.now();var e=this.jFetch("event:tap:event");this.jFetch("event:tap:options");e&&t.isPrimaryTouch()&&(this.jDel("event:tap:event"),e.id===t.getPrimaryTouchId()&&t.timeStamp-e.timeStamp<=200&&Math.sqrt(Math.pow(t.getPrimaryTouch().pageX-e.x,2)+Math.pow(t.getPrimaryTouch().pageY-e.y,2))<=10&&(this.jDel("event:btnclick:btnclickEvent"),t.stop(),e.pushToEvents(t),this.jCallEvent("tap",e)))}},h.Event.Custom.dbltap=new h.Class(h.extend(h.Event.Custom,{type:"dbltap",timedout:!1,tm:null,init:function(t,e){this.x=e.x,this.y=e.y,this.clientX=e.clientX,this.clientY=e.clientY,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e)}})),h.Event.Custom.dbltap.handler={options:{threshold:300},add:function(t){this.jStore("event:dbltap:options",h.extend(h.detach(h.Event.Custom.dbltap.handler.options),t||{})),this.jAddEvent("tap",h.Event.Custom.dbltap.handler.handle,1)},jRemove:function(){this.jRemoveEvent("tap",h.Event.Custom.dbltap.handler.handle)},handle:function(t){var e=this.jFetch("event:dbltap:event"),i=this.jFetch("event:dbltap:options");e?(clearTimeout(e.tm),this.jDel("event:dbltap:event"),e.timedout||(e.pushToEvents(t),t.stopQueue().stop(),this.jCallEvent("dbltap",e))):((e=new h.Event.Custom.dbltap(this,t)).tm=setTimeout(function(){e.timedout=!0,t.isQueueStopped=h.$false,this.jCallEvent("tap",t)}.jBind(this),i.threshold+10),this.jStore("event:dbltap:event",e),t.stopQueue())}},f=(v=t).$,v.Event.Custom.touchdrag=new v.Class(v.extend(v.Event.Custom,{type:"touchdrag",state:"dragstart",id:null,dragged:!1,init:function(t,e,i){var o=e.getPrimaryTouch();this.id=o.pointerId||o.identifier,this.clientX=o.clientX,this.clientY=o.clientY,this.pageX=o.pageX,this.pageY=o.pageY,this.x=o.pageX,this.y=o.pageY,this.timeStamp=e.timeStamp,this.button=0,this.target=t,this.pushToEvents(e),this.state=i}})),v.Event.Custom.touchdrag.handler={add:function(){var t=v.Event.Custom.touchdrag.handler.onTouchMove.jBind(this),e=v.Event.Custom.touchdrag.handler.onTouchEnd.jBind(this);this.jAddEvent(["touchstart","pointerdown"],v.Event.Custom.touchdrag.handler.onTouchStart,1),this.jAddEvent(["touchend","pointerup"],v.Event.Custom.touchdrag.handler.onTouchEnd,1),this.jAddEvent(["touchmove","pointermove"],v.Event.Custom.touchdrag.handler.onTouchMove,1),this.jStore("event:touchdrag:listeners:document:move",t),this.jStore("event:touchdrag:listeners:document:end",e),f(document).jAddEvent("pointermove",t,1),f(document).jAddEvent("pointerup",e,1)},jRemove:function(){this.jRemoveEvent(["touchstart","pointerdown"],v.Event.Custom.touchdrag.handler.onTouchStart),this.jRemoveEvent(["touchend","pointerup"],v.Event.Custom.touchdrag.handler.onTouchEnd),this.jRemoveEvent(["touchmove","pointermove"],v.Event.Custom.touchdrag.handler.onTouchMove),f(document).jRemoveEvent("pointermove",this.jFetch("event:touchdrag:listeners:document:move")||v.$F,1),f(document).jRemoveEvent("pointerup",this.jFetch("event:touchdrag:listeners:document:end")||v.$F,1),this.jDel("event:touchdrag:listeners:document:move"),this.jDel("event:touchdrag:listeners:document:end")},onTouchStart:function(t){t.isPrimaryTouch()&&(t=new v.Event.Custom.touchdrag(this,t,"dragstart"),this.jStore("event:touchdrag:dragstart",t))},onTouchEnd:function(t){var e=this.jFetch("event:touchdrag:dragstart");e&&e.dragged&&e.id===t.getPrimaryTouchId()&&(e=new v.Event.Custom.touchdrag(this,t,"dragend"),this.jDel("event:touchdrag:dragstart"),this.jCallEvent("touchdrag",e))},onTouchMove:function(t){var e=this.jFetch("event:touchdrag:dragstart");e&&t.isPrimaryTouch()&&(e.id===t.getPrimaryTouchId()?(!e.dragged&&10<Math.sqrt(Math.pow(t.getPrimaryTouch().pageX-e.x,2)+Math.pow(t.getPrimaryTouch().pageY-e.y,2))&&(e.dragged=!0,this.jCallEvent("touchdrag",e)),e.dragged&&(e=new v.Event.Custom.touchdrag(this,t,"dragmove"),this.jCallEvent("touchdrag",e))):this.jDel("event:touchdrag:dragstart"))}},w=(x=t).$,z=null,x.Event.Custom.pinch=new x.Class(x.extend(x.Event.Custom,{type:"pinch",state:"pinchstart",init:function(t,e,i,o){this.target=t,this.state=i,this.x=o.x,this.y=o.y,this.timeStamp=e.timeStamp,this.scale=o.scale,this.space=o.space,this.zoom=o.zoom,this.state=i,this.centerPoint=o.centerPoint,this.points=o.points,this.pushToEvents(e)}})),x.Event.Custom.pinch.handler={variables:{x:0,y:0,space:0,scale:1,zoom:0,startSpace:0,startScale:1,started:!1,dragged:!1,points:[],centerPoint:{x:0,y:0}},add:function(t){z||((i=w(window).jGetSize()).width=Math.min(i.width,i.height),i.height=i.width,z=Math.pow(M({x:0,y:0},{x:i.width,y:i.height}),2));var e=x.Event.Custom.pinch.handler.onTouchMove.jBind(this),i=x.Event.Custom.pinch.handler.onTouchEnd.jBind(this);this.jAddEvent(["click","tap"],x.Event.Custom.pinch.handler.onClick,1),this.jAddEvent(["touchstart","pointerdown"],x.Event.Custom.pinch.handler.onTouchStart,1),this.jAddEvent(["touchend","pointerup"],x.Event.Custom.pinch.handler.onTouchEnd,1),this.jAddEvent(["touchmove","pointermove"],x.Event.Custom.pinch.handler.onTouchMove,1),this.jStore("event:pinch:listeners:touchmove",e),this.jStore("event:pinch:listeners:touchend",i),x.doc.jAddEvent("pointermove",e,1),x.doc.jAddEvent("pointerup",i,1)},jRemove:function(){this.jRemoveEvent(["click","tap"],x.Event.Custom.pinch.handler.onClick),this.jRemoveEvent(["touchstart","pointerdown"],x.Event.Custom.pinch.handler.onTouchStart),this.jRemoveEvent(["touchend","pointerup"],x.Event.Custom.pinch.handler.onTouchEnd),this.jRemoveEvent(["touchmove","pointermove"],x.Event.Custom.pinch.handler.onTouchMove),x.doc.jRemoveEvent("pointermove",this.jFetch("event:pinch:listeners:touchmove")),x.doc.jRemoveEvent("pointerup",this.jFetch("event:pinch:listeners:touchend")),this.jDel("event:pinch:listeners:touchmove"),this.jDel("event:pinch:listeners:touchend"),this.jDel("event:pinch:pinchstart"),this.jDel("event:pinch:variables"),this.jDel("event:pinch:activepoints");var t=this.jFetch("event:pinch:cache");t&&t.clear(),this.jDel("event:pinch:cache")},onClick:function(t){t.stop()},setVariables:function(t,e){var i,o,n,s,a,h=e.space;1<t.length?(e.space=(i=t,o=e,n=Array.prototype.slice.call(i),s=Math.abs(n[1].pageX-n[0].pageX),a=Math.abs(n[1].pageY-n[0].pageY),i=Math.min(n[1].pageX,n[0].pageX)+s/2,s=Math.min(n[1].pageY,n[0].pageY)+a/2,o.points=[n[0],n[1]],a=Math.pow(M({x:n[0].pageX,y:n[0].pageY},{x:n[1].pageX,y:n[1].pageY}),2),o.centerPoint={x:i,y:s},o.x=o.centerPoint.x,o.y=o.centerPoint.y,a),e.startSpace||(e.startSpace=e.space),h>e.space?e.zoom=-1:h<e.space?e.zoom=1:e.zoom=0,e.scale=e.space/z):e.points=Array.prototype.slice.call(t,0,2)},onTouchMove:function(t){var e=this.jFetch("event:pinch:cache"),i=this.jFetch("event:pinch:variables")||x.extend({},x.Event.Custom.pinch.handler.variables),o=this.jFetch("event:pinch:activepoints");i.started&&(t.pointerId&&!O(t,e,!0)||(t.stop(),x.Event.Custom.pinch.handler.setVariables(F(k(t,e),o),i),i=new x.Event.Custom.pinch(this,t,"pinchmove",i),this.jCallEvent("pinch",i)))},onTouchStart:function(t){var e,i,o=this.jFetch("event:pinch:cache"),n=this.jFetch("event:pinch:activepoints");"mouse"!==t.pointerType&&(n||(n=w([]),this.jStore("event:pinch:activepoints",n)),n.length||w(t.target).jAddEvent(["touchend","pointerup"],this.jFetch("event:pinch:listeners:touchend"),1),o||(o=new Map,this.jStore("event:pinch:cache",o)),O(t,o),$(i=k(t,o),n),2===i.length&&(e=this.jFetch("event:pinch:pinchstart"),o=this.jFetch("event:pinch:variables")||x.extend({},x.Event.Custom.pinch.handler.variables),x.Event.Custom.pinch.handler.setVariables(F(i,n),o),e||(e=new x.Event.Custom.pinch(this,t,"pinchstart",o),this.jStore("event:pinch:pinchstart",e),this.jStore("event:pinch:variables",o),z=o.space,this.jCallEvent("pinch",e),o.started=!0)))},onTouchEnd:function(t){var e,i,o,n,s,a,h=this.jFetch("event:pinch:cache");"mouse"!==t.pointerType&&(!t.pointerId||h&&h.has(t.pointerId))&&(o=this.jFetch("event:pinch:pinchstart"),n=this.jFetch("event:pinch:variables"),s=this.jFetch("event:pinch:activepoints"),a=k(t,h),i=h,(e=t).pointerId&&"touch"===e.pointerType&&i&&i.has(e.pointerId)&&i.delete(e.pointerId),e=I(a,s),o&&n&&n.started&&e&&s&&(e&&$(a,s),e="pinchend",1<a.length?e="pinchresize":(t.target.jRemoveEvent(["touchend","pointerup"],this.jFetch("event:pinch:listeners:touchend")),h&&h.clear(),this.jDel("event:pinch:pinchstart"),this.jDel("event:pinch:variables"),this.jDel("event:pinch:cache"),this.jDel("event:pinch:activepoints")),x.Event.Custom.pinch.handler.setVariables(F(a,s),n),o=new x.Event.Custom.pinch(this,t,e,n),this.jCallEvent("pinch",o)))}},(b=t).$,b.Event.Custom.mousescroll=new b.Class(b.extend(b.Event.Custom,{type:"mousescroll",init:function(t,e,i,o,n,s,a){var h=e.jGetPageXY();this.x=h.x,this.y=h.y,this.timeStamp=e.timeStamp,this.target=t,this.delta=i||0,this.deltaX=o||0,this.deltaY=n||0,this.deltaZ=s||0,this.deltaFactor=a||0,this.deltaMode=e.deltaMode||0,this.isMouse=!1,this.pushToEvents(e)}})),b.Event.Custom.mousescroll.handler={eventType:"onwheel"in document||8<b.browser.ieMode?"wheel":"mousewheel",add:function(){this.jAddEvent(b.Event.Custom.mousescroll.handler.eventType,b.Event.Custom.mousescroll.handler.handle,1)},jRemove:function(){this.jRemoveEvent(b.Event.Custom.mousescroll.handler.eventType,b.Event.Custom.mousescroll.handler.handle,1)},handle:function(t){var e=0,i=0,o=0,n=0;t.detail&&(o=-1*t.detail),void 0!==t.wheelDelta&&(o=t.wheelDelta),void 0!==t.wheelDeltaY&&(o=t.wheelDeltaY),void 0!==t.wheelDeltaX&&(i=-1*t.wheelDeltaX),t.deltaY&&(o=-1*t.deltaY),t.deltaX&&(i=t.deltaX),0===o&&0===i||(e=0===o?i:o,n=Math.max(Math.abs(o),Math.abs(i)),(!j||n<j)&&(j=n),n=0<e?"floor":"ceil",e=Math[n](e/j),i=Math[n](i/j),o=Math[n](o/j),y&&clearTimeout(y),y=setTimeout(P,200),(i=new b.Event.Custom.mousescroll(this,t,e,i,o,0,j)).isMouse=(o=j,t=t.deltaMode||0,50<o||1===t&&!("win"==b.browser.platform&&o<1)||0==o%12||0==o%4.000244140625),this.jCallEvent("mousescroll",i))}},h.win=h.$(window),h.doc=h.$(document),t}();(function(o){if(!o)throw"MagicJS not found";var n=o.$,s=window.URL||window.webkitURL||null;e.ImageLoader=new o.Class({img:null,ready:!1,options:{onprogress:o.$F,onload:o.$F,onabort:o.$F,onerror:o.$F,oncomplete:o.$F,onxhrerror:o.$F,xhr:!1,progressiveLoad:!0},size:null,_timer:null,loadedBytes:0,_handlers:{onprogress:function(t){t.target&&(200===t.target.status||304===t.target.status)&&t.lengthComputable&&(this.options.onprogress.jBind(null,(t.loaded-(this.options.progressiveLoad?this.loadedBytes:0))/t.total).jDelay(1),this.loadedBytes=t.loaded)},onload:function(t){t&&n(t).stop(),this._unbind(),this.ready||(this.ready=!0,this._cleanup(),this.options.xhr||this.options.onprogress.jBind(null,1).jDelay(1),this.options.onload.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1))},onabort:function(t){t&&n(t).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onabort.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)},onerror:function(t){t&&n(t).stop(),this._unbind(),this.ready=!1,this._cleanup(),this.options.onerror.jBind(null,this).jDelay(1),this.options.oncomplete.jBind(null,this).jDelay(1)}},_bind:function(){n(["load","abort","error"]).jEach(function(t){this.img.jAddEvent(t,this._handlers["on"+t].jBindAsEvent(this).jDefer(1))},this)},_unbind:function(){if(this._timer){try{clearTimeout(this._timer)}catch(t){}this._timer=null}n(["load","abort","error"]).jEach(function(t){this.img.jRemoveEvent(t)},this)},_cleanup:function(){var t;this.jGetSize(),this.img.jFetch("new")&&(t=this.img.parentNode,this.img.jRemove().jDel("new").jSetCss({position:"static",top:"auto"}),t.kill())},loadBlob:function(t){var e,i=new XMLHttpRequest;n(["abort","progress"]).jEach(function(e){i["on"+e]=n(function(t){this._handlers["on"+e].call(this,t)}).jBind(this)},this),i.onerror=n(function(){this.options.onxhrerror.jBind(null,this).jDelay(1),this.options.xhr=!1,this._bind(),this.img.src=t}).jBind(this),i.onload=n(function(){200===i.status||304===i.status?(e=i.response,this._bind(),!s||o.browser.trident||"ios"===o.browser.platform&&o.browser.version<537?this.img.src=t:this.img.setAttribute("src",s.createObjectURL(e))):this._handlers.onerror.call(this)}).jBind(this),i.open("GET",t),i.responseType="blob",i.send()},init:function(t,e){var i;this.options=o.extend(this.options,e),this.img=n(t)||o.$new("img",{},{"max-width":"none","max-height":"none"}).jAppendTo(o.$new("div").jAddClass("magic-temporary-img").jSetCss({position:"absolute",top:-1e4,width:10,height:10,overflow:"hidden"}).jAppendTo(document.body)).jStore("new",!0),o.browser.features.xhr2&&this.options.xhr&&"string"==o.jTypeOf(t)?this.loadBlob(t):(i=function(){(this.isReady()?this._handlers.onload:this._handlers.onerror).call(this),i=null}.jBind(this),this._bind(),"string"==o.jTypeOf(t)?this.img.src=t:(o.browser.trident&&5==o.browser.version&&o.browser.ieMode<9&&(this.img.onreadystatechange=function(){/loaded|complete/.test(this.img.readyState)&&(this.img.onreadystatechange=null,i&&i())}.jBind(this)),this.img.src=t.getAttribute("src")),this.img&&this.img.complete&&i&&(this._timer=i.jDelay(100)))},destroy:function(){return this._unbind(),this._cleanup(),this.ready=!1,this},isReady:function(){var t=this.img;return t.naturalWidth?0<t.naturalWidth:t.readyState?"complete"==t.readyState:0<t.width},jGetSize:function(){return this.size||(this.size={width:this.img.naturalWidth||this.img.width,height:this.img.naturalHeight||this.img.height})}})})(e),function(n){if(!n)throw"MagicJS not found";var o;n.FX||(o=n.$,n.FX=new n.Class({init:function(t,e){this.el=n.$(t),this.options=n.extend(this.options,e),this.timer=!1,this.easeFn=this.cubicBezierAtTime,e=n.FX.Transition[this.options.transition]||this.options.transition,"function"===n.jTypeOf(e)?this.easeFn=e:this.cubicBezier=this.parseCubicBezier(e)||this.parseCubicBezier("ease"),"string"==n.jTypeOf(this.options.cycles)&&(this.options.cycles="infinite"===this.options.cycles?1/0:parseInt(this.options.cycles)||1)},options:{fps:60,duration:600,transition:"ease",cycles:1,direction:"normal",onStart:n.$F,onComplete:n.$F,onBeforeRender:n.$F,onAfterRender:n.$F,forceAnimation:!1,roundCss:!1},styles:null,cubicBezier:null,easeFn:null,setTransition:function(t){this.options.transition=t,t=n.FX.Transition[this.options.transition]||this.options.transition,"function"===n.jTypeOf(t)?this.easeFn=t:(this.easeFn=this.cubicBezierAtTime,this.cubicBezier=this.parseCubicBezier(t)||this.parseCubicBezier("ease"))},start:function(t){var e,i=/\%$/;for(e in this.styles=t||{},this.cycle=0,this.state=0,this.curFrame=0,this.pStyles={},this.alternate="alternate"===this.options.direction||"alternate-reverse"===this.options.direction,this.continuous="continuous"===this.options.direction||"continuous-reverse"===this.options.direction,this.styles)i.test(this.styles[e][0])&&(this.pStyles[e]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles[e].reverse();return this.startTime=n.now(),this.finishTime=this.startTime+this.options.duration,this.options.onStart.call(),0===this.options.duration?(this.render(1),this.options.onComplete.call()):(this.loopBind=this.loop.jBind(this),!this.options.forceAnimation&&n.browser.features.requestAnimationFrame?this.timer=n.browser.requestAnimationFrame.call(window,this.loopBind):this.timer=this.loopBind.interval(Math.round(1e3/this.options.fps))),this},stopAnimation:function(){this.timer&&(!this.options.forceAnimation&&n.browser.features.requestAnimationFrame&&n.browser.cancelAnimationFrame?n.browser.cancelAnimationFrame.call(window,this.timer):clearInterval(this.timer),this.timer=!1)},stop:function(t){return t=!!n.defined(t)&&t,this.stopAnimation(),t&&(this.render(1),this.options.onComplete.jDelay(10)),this},calc:function(t,e,i){return t=parseFloat(t),((e=parseFloat(e))-t)*i+t},loop:function(){var t=n.now(),e=(t-this.startTime)/this.options.duration,i=Math.floor(e);if(t>=this.finishTime&&i>=this.options.cycles)return this.stopAnimation(),this.render(1),this.options.onComplete.jDelay(10),this;if(this.alternate&&this.cycle<i)for(var o in this.styles)this.styles[o].reverse();this.cycle=i,!this.options.forceAnimation&&n.browser.features.requestAnimationFrame&&(this.timer=n.browser.requestAnimationFrame.call(window,this.loopBind)),this.render((this.continuous?i:0)+this.easeFn(e%1))},render:function(t){var e,i={};for(e in this.styles)"opacity"===e?i[e]=Math.round(100*this.calc(this.styles[e][0],this.styles[e][1],t))/100:(i[e]=this.calc(this.styles[e][0],this.styles[e][1],t),this.pStyles[e]&&(i[e]+="%"));this.options.onBeforeRender(i,this.el),this.set(i),this.options.onAfterRender(i,this.el)},set:function(t){return this.el.jSetCss(t)},parseCubicBezier:function(t){var e,i=null;if("string"!==n.jTypeOf(t))return null;switch(t){case"linear":i=o([0,0,1,1]);break;case"ease":i=o([.25,.1,.25,1]);break;case"ease-in":i=o([.42,0,1,1]);break;case"ease-out":i=o([0,0,.58,1]);break;case"ease-in-out":i=o([.42,0,.58,1]);break;case"easeInSine":i=o([.47,0,.745,.715]);break;case"easeOutSine":i=o([.39,.575,.565,1]);break;case"easeInOutSine":i=o([.445,.05,.55,.95]);break;case"easeInQuad":i=o([.55,.085,.68,.53]);break;case"easeOutQuad":i=o([.25,.46,.45,.94]);break;case"easeInOutQuad":i=o([.455,.03,.515,.955]);break;case"easeInCubic":i=o([.55,.055,.675,.19]);break;case"easeOutCubic":i=o([.215,.61,.355,1]);break;case"easeInOutCubic":i=o([.645,.045,.355,1]);break;case"easeInQuart":i=o([.895,.03,.685,.22]);break;case"easeOutQuart":i=o([.165,.84,.44,1]);break;case"easeInOutQuart":i=o([.77,0,.175,1]);break;case"easeInQuint":i=o([.755,.05,.855,.06]);break;case"easeOutQuint":i=o([.23,1,.32,1]);break;case"easeInOutQuint":i=o([.86,0,.07,1]);break;case"easeInExpo":i=o([.95,.05,.795,.035]);break;case"easeOutExpo":i=o([.19,1,.22,1]);break;case"easeInOutExpo":i=o([1,0,0,1]);break;case"easeInCirc":i=o([.6,.04,.98,.335]);break;case"easeOutCirc":i=o([.075,.82,.165,1]);break;case"easeInOutCirc":i=o([.785,.135,.15,.86]);break;case"easeInBack":i=o([.6,-.28,.735,.045]);break;case"easeOutBack":i=o([.175,.885,.32,1.275]);break;case"easeInOutBack":i=o([.68,-.55,.265,1.55]);break;default:if((t=t.replace(/\s/g,"")).match(/^cubic-bezier\((?:-?[0-9\.]{0,}[0-9]{1,},){3}(?:-?[0-9\.]{0,}[0-9]{1,})\)$/))for(e=(i=t.replace(/^cubic-bezier\s*\(|\)$/g,"").split(",")).length-1;0<=e;e--)i[e]=parseFloat(i[e])}return o(i)},cubicBezierAtTime:function(t){var e,d=0,l=0,m=0,i=0,o=0,n=0,s=this.options.duration;function c(t){return((d*t+l)*t+m)*t}return m=3*this.cubicBezier[0],l=3*(this.cubicBezier[2]-this.cubicBezier[0])-m,d=1-m-l,n=3*this.cubicBezier[1],o=3*(this.cubicBezier[3]-this.cubicBezier[1])-n,i=1-n-o,e=function(t,e){var i,o,n,s,a,h;function r(t){return 0<=t?t:0-t}for(n=t,h=0;h<8;h++){if(r(s=c(n)-t)<e)return n;if(r(a=function(t){return(3*d*t+2*l)*t+m}(n))<1e-6)break;n-=s/a}if(o=1,(n=t)<(i=0))return i;if(o<n)return o;for(;i<o;){if(r((s=c(n))-t)<e)return n;s<t?i=n:o=n,n=.5*(o-i)+i}return n}(t,e=1/(200*s)),((i*e+o)*e+n)*e}}),n.FX.Transition={linear:"linear",sineIn:"easeInSine",sineOut:"easeOutSine",expoIn:"easeInExpo",expoOut:"easeOutExpo",quadIn:"easeInQuad",quadOut:"easeOutQuad",cubicIn:"easeInCubic",cubicOut:"easeOutCubic",backIn:"easeInBack",backOut:"easeOutBack",elasticIn:function(t,e){return e=e||[],Math.pow(2,10*--t)*Math.cos(20*t*Math.PI*(e[0]||1)/3)},elasticOut:function(t,e){return 1-n.FX.Transition.elasticIn(1-t,e)},bounceIn:function(t){for(var e=0,i=1;;e+=i,i/=2)if((7-4*e)/11<=t)return i*i-Math.pow((11-6*e-11*t)/4,2)},bounceOut:function(t){return 1-n.FX.Transition.bounceIn(1-t)},none:function(t){return 0}})}(e),function(i){if(!i)throw"MagicJS not found";i.PFX||(i.$,i.PFX=new i.Class(i.FX,{init:function(t,e){this.el_arr=t,this.options=i.extend(this.options,e),this.timer=!1,this.$parent.init()},start:function(t){var e,i,o=/\%$/,n=t.length;for(this.styles_arr=t,this.pStyles_arr=new Array(n),i=0;i<n;i++)for(e in this.pStyles_arr[i]={},t[i])o.test(t[i][e][0])&&(this.pStyles_arr[i][e]=!0),"reverse"!==this.options.direction&&"alternate-reverse"!==this.options.direction&&"continuous-reverse"!==this.options.direction||this.styles_arr[i][e].reverse();return this.$parent.start({}),this},render:function(t){for(var e=0;e<this.el_arr.length;e++)this.el=i.$(this.el_arr[e]),this.styles=this.styles_arr[e],this.pStyles=this.pStyles_arr[e],this.$parent.render(t)}}))}(e),function(a){if(!a)throw"MagicJS not found";a.Tooltip||(a.$,a.Tooltip=function(t,e){var s=this.tooltip=a.$new("div",null,{position:"absolute","z-index":999}).jAddClass("MagicToolboxTooltip");a.$(t).jAddEvent("mouseover",function(){s.jAppendTo(document.body)}),a.$(t).jAddEvent("mouseout",function(){s.jRemove()}),a.$(t).jAddEvent("mousemove",function(t){var e=a.$(t).jGetPageXY(),i=s.jGetSize(),o=a.$(window).jGetSize(),t=a.$(window).jGetScroll();function n(t,e,i){return i<(t-e)/2?i:(t+e)/2<i?i-e:(t-e)/2}s.jSetCss({left:t.x+n(o.width,i.width+40,e.x-t.x)+20,top:t.y+n(o.height,i.height+40,e.y-t.y)+20})}),this.text(e)},a.Tooltip.prototype.text=function(t){this.tooltip.firstChild&&this.tooltip.removeChild(this.tooltip.firstChild),this.tooltip.append(document.createTextNode(t))})}(e),function(n){if(!n)throw"MagicJS not found";n.MessageBox||(n.$,n.Message=function(t,e,i,o){this.hideTimer=null,this.messageBox=n.$new("span",null,{position:"absolute","z-index":999,visibility:"hidden",opacity:.8}).jAddClass(o||"").jAppendTo(i||document.body),this.setMessage(t),this.show(e)},n.Message.prototype.show=function(t){this.messageBox.show(),this.hideTimer=this.hide.jBind(this).jDelay(n.ifndef(t,5e3))},n.Message.prototype.hide=function(t){clearTimeout(this.hideTimer),this.hideTimer=null,this.messageBox&&!this.hideFX&&(this.hideFX=new e.FX(this.messageBox,{duration:n.ifndef(t,500),onComplete:function(){this.messageBox.kill(),delete this.messageBox,this.hideFX=null}.jBind(this)}).start({opacity:[this.messageBox.jGetCss("opacity"),0]}))},n.Message.prototype.setMessage=function(t){this.messageBox.firstChild&&this.tooltip.removeChild(this.messageBox.firstChild),this.messageBox.append(document.createTextNode(t))})}(e),function(a){if(!a)throw"MagicJS not found";var n,s,h,r,d,t;a.Options||(n=a.$,s=null,h={boolean:1,array:2,number:3,function:4,string:100},r={boolean:function(t,e,i){if("boolean"!=a.jTypeOf(e)){if(i||"string"!=a.jTypeOf(e))return!1;if(!/^(true|false)$/.test(e))return!1;e=e.jToBool()}return!(t.hasOwnProperty("enum")&&!n(t.enum).contains(e))&&(s=e,!0)},string:function(t,e,i){return"string"===a.jTypeOf(e)&&(!(t.hasOwnProperty("enum")&&!n(t.enum).contains(e))&&(s=""+e,!0))},number:function(t,e,i){var o="string"==a.jTypeOf(e)&&/%$/.test(e);return(!i||0!=typeof e)&&(e=parseFloat(e),!isNaN(e)&&(isNaN(t.minimum)&&(t.minimum=Number.NEGATIVE_INFINITY),isNaN(t.maximum)&&(t.maximum=Number.POSITIVE_INFINITY),!(t.hasOwnProperty("enum")&&!n(t.enum).contains(e))&&(!(t.minimum>e||e>t.maximum)&&(s=o?e+"%":e,!0))))},array:function(t,e,i){if("string"===a.jTypeOf(e))try{e=window.JSON.parse(e)}catch(t){return!1}return"array"===a.jTypeOf(e)&&(s=e,!0)},function:function(t,e,i){return"function"===a.jTypeOf(e)&&(s=e,!0)}},d=function(t,e,i){var o=t.hasOwnProperty("oneOf")?t.oneOf:[t];if("array"!=a.jTypeOf(o))return!1;for(var n=0,s=o.length-1;n<=s;n++)if(r[o[n].type](o[n],e,i))return!0;return!1},t=function(t){this.schema={},this.options={},this.parseSchema(t)},a.extend(t.prototype,{parseSchema:function(t){var e,i;for(e in t)if(t.hasOwnProperty(e)&&(i=(e+"").jTrim().jCamelize(),!this.schema.hasOwnProperty(i))){if(this.schema[i]=function(t){var e,i,o,n;if(t.hasOwnProperty("oneOf"))for(o=t.oneOf.length,e=0;e<o;e++)for(i=e+1;i<o;i++)h[t.oneOf[e].type]>h[t.oneOf[i].type]&&(n=t.oneOf[e],t.oneOf[e]=t.oneOf[i],t.oneOf[i]=n);return t}(t[e]),!function(t){var e=t.hasOwnProperty("oneOf")?t.oneOf:[t];if("array"!=a.jTypeOf(e))return!1;for(var i=e.length-1;0<=i;i--){if(!e[i].type||!h.hasOwnProperty(e[i].type))return!1;if(a.defined(e[i].enum)){if("array"!==a.jTypeOf(e[i].enum))return!1;for(var o=e[i].enum.length-1;0<=o;o--)if(!r[e[i].type]({type:e[i].type},e[i].enum[o],!0))return!1}}return!(t.hasOwnProperty("default")&&!d(t,t.default,!0))}(this.schema[i]))throw"Incorrect definition of the '"+e+"' parameter in "+t;this.options[i]=void 0}},set:function(t,e){t=(t+"").jTrim().jCamelize(),"string"==a.jTypeOf(e)&&(e=e.jTrim()),this.schema.hasOwnProperty(t)&&(s=e,d(this.schema[t],e)&&(this.options[t]=s),s=null)},get:function(t){if(t=(t+"").jTrim().jCamelize(),this.schema.hasOwnProperty(t))return a.defined(this.options[t])?this.options[t]:this.schema[t].default},fromJSON:function(t){for(var e in t)this.set(e,t[e])},getJSON:function(){var t,e=a.extend({},this.options);for(t in e)void 0===e[t]&&void 0!==this.schema[t].default&&(e[t]=this.schema[t].default);return e},fromString:function(t){n(t.split(";")).jEach(n(function(t){t=t.split(":"),this.set(t.shift().jTrim(),t.join(":"))}).jBind(this))},exists:function(t){return t=(t+"").jTrim().jCamelize(),this.schema.hasOwnProperty(t)},isset:function(t){return t=(t+"").jTrim().jCamelize(),this.exists(t)&&a.defined(this.options[t])},jRemove:function(t){t=(t+"").jTrim().jCamelize(),this.exists(t)&&(delete this.options[t],delete this.schema[t])}}),a.Options=t)}(e),function(t){if(!t)throw"MagicJS not found";var e,i,o=t.$;t.SVGImage||(e="http://www.w3.org/2000/svg",(i=function(t){this.filters={},this.originalImage=o(t),this.canvas=o(document.createElementNS(e,"svg")),this.canvas.setAttribute("width",this.originalImage.naturalWidth||this.originalImage.width),this.canvas.setAttribute("height",this.originalImage.naturalHeight||this.originalImage.height),this.image=o(document.createElementNS(e,"image")),this.image.setAttributeNS("http://www.w3.org/1999/xlink","href",this.originalImage.getAttribute("src")),this.image.setAttribute("width","100%"),this.image.setAttribute("height","100%"),this.image.jAppendTo(this.canvas)}).prototype.getNode=function(){return this.canvas},i.prototype.blur=function(t){if(!(Math.round(t)<1))return this.filters.blur?this.filters.blur.firstChild.setAttribute("stdDeviation",t):(this.filters.blur=o(document.createElementNS(e,"filter")),this.filters.blur.setAttribute("id","filterBlur"),this.filters.blur.appendChild(o(document.createElementNS(e,"feGaussianBlur")).setProps({in:"SourceGraphic",stdDeviation:t})),this.filters.blur.jAppendTo(this.canvas),this.image.setAttribute("filter","url(#filterBlur)")),this},t.SVGImage=i)}(e);var u,c,i=(c=(u=e).$,t.prototype={setupContent:function(){this.root=u.$new("div").jAddClass(this.rootCSS).jAddClass(this.rootCSS+"-"+this.settings.orientation).jSetCss({visibility:"hidden"}),this.wrapper=u.$new("div").jAddClass(this.rootCSS+"-wrapper").jAppendTo(this.root),this.root.jAppendTo(this.parent),c(["prev","next"]).jEach(function(t){this.buttons[t]=u.$new("button").jAddClass(this.rootCSS+"-button").jAddClass(this.rootCSS+"-button-"+t).jAppendTo(this.root).jAddEvent("btnclick tap",function(t,e){c(t).events[0].stop().stopQueue(),c(t).stopDistribution(),this.scroll(e)}.jBindAsEvent(this,t))}.jBind(this)),this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"),this.context=u.$new("ul").jAddEvent("btnclick tap",function(t){t.stop()})},addItem:function(t){var e=u.$new("li").jAddClass(this.itemCSS).append(t).jAppendTo(this.context);return new u.ImageLoader(t,{oncomplete:this.reflow.jBind(this)}),this.items.push(e),e},selectItem:function(t){var e=this.selectedItem||this.context.byClass(this.itemCSS+"-selected")[0];e&&c(e).jRemoveClass(this.itemCSS+"-selected"),this.selectedItem=c(t),this.selectedItem&&(this.selectedItem.jAddClass(this.itemCSS+"-selected"),this.scroll(this.selectedItem))},run:function(){if(this.wrapper!==this.context.parentNode)return c(this.context).jAppendTo(this.wrapper),this.initDrag(),c(window).jAddEvent("resize",this.resizeCallback=this.reflow.jBind(this)),void this.run.jBind(this).jDelay(1);var t=this.parent.jGetSize();0<t.height&&t.height>t.width?this.setOrientation("vertical"):this.setOrientation("horizontal"),this.reflow(),this.root.jSetCss({visibility:""})},stop:function(){this.resizeCallback&&c(window).jRemoveEvent("resize",this.resizeCallback),this.root.kill()},scroll:function(t,e){var i,o,n,s={x:0,y:0},a="vertical"==this.settings.orientation?"top":"left",h="vertical"==this.settings.orientation?"height":"width",r="vertical"==this.settings.orientation?"y":"x",d=this.context.parentNode.jGetSize()[h],l=this.context.parentNode.jGetPosition(),m=this.context.jGetSize()[h],c=[];if(this.scrollFX?this.scrollFX.stop():this.context.jSetCss("transition",u.browser.cssTransformProp+String.fromCharCode(32)+"0s"),void 0===e&&(e=600),i=this.context.jGetPosition(),"string"==u.jTypeOf(t))s[r]="next"==t?Math.max(i[a]-l[a]-d,d-m):Math.min(i[a]-l[a]+d,0);else{if("element"!=u.jTypeOf(t))return;o=t.jGetSize(),n=t.jGetPosition(),s[r]=Math.min(0,Math.max(d-m,i[a]+d/2-n[a]-o[h]/2))}0<=(r=u.browser.gecko&&"android"==u.browser.platform||u.browser.ieMode&&u.browser.ieMode<10?("string"==u.jTypeOf(t)&&s[r]==i[a]-l[a]&&(i[a]+=0==i[a]-l[a]?30:-30),s["margin-"+a]=[m<=d?0:i[a]-l[a],s[r]],delete s.x,delete s.y,this.selectorsMoveFX||(this.selectorsMoveFX=new u.PFX([this.context],{duration:500})),c.push(s),this.selectorsMoveFX.start(c),s["margin-"+a][1]):(this.context.jSetCss({transition:u.browser.cssTransformProp+String.fromCharCode(32)+e+"ms ease",transform:"translate3d("+s.x+"px, "+s.y+"px, 0)"}),s[r]))?(this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"),this.buttons.prev.disabled=!0):(this.buttons.prev.jRemoveClass(this.rootCSS+"-button-disabled"),this.buttons.prev.disabled=!1),r<=d-m?(this.buttons.next.jAddClass(this.rootCSS+"-button-disabled"),this.buttons.next.disabled=!0):(this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled"),this.buttons.next.disabled=!1),r=null},initDrag:function(){var e,o,i,n,s,a,h,r,d,l={x:0,y:0},t=c(function(t){if(l={x:0,y:0},this.settings.orientation,d="vertical"==this.settings.orientation?"height":"width",e="vertical"==this.settings.orientation?"y":"x",h=this.context.parentNode.jGetSize()[d],d=this.context.jGetSize()[d],!(0<=(h=h-d)))if("dragstart"==t.state)void 0===r&&(r=0),this.context.jSetCssProp("transition",u.browser.cssTransformProp+String.fromCharCode(32)+"0ms"),i=t[e],s=t.y,n=t.x,a=!1;else{if("dragend"==t.state){if(a)return;d=function(t){for(var e=0,i=1.5;i<=90;i+=1.5)e+=t*Math.cos(i/Math.PI/2);return o<0&&(e*=-1),e}(Math.abs(o)),(r+=d)<=h&&(r=h),0<=r&&(r=0),l[e]=r,this.context.jSetCssProp("transition",u.browser.cssTransformProp+String.fromCharCode(32)+300+"ms  cubic-bezier(.0, .0, .0, 1)"),this.context.jSetCssProp("transform","translate3d("+l.x+"px, "+l.y+"px, 0px)"),o=0}else{if(a)return;"horizontal"==this.settings.orientation&&Math.abs(t.x-n)>Math.abs(t.y-s)||"vertical"==this.settings.orientation&&Math.abs(t.x-n)<Math.abs(t.y-s)?(t.stop(),o=t[e]-i,r+=o,l[e]=r,this.context.jSetCssProp("transform","translate3d("+l.x+"px, "+l.y+"px, 0px)"),0<=r?this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.prev.jRemoveClass(this.rootCSS+"-button-disabled"),r<=h?this.buttons.next.jAddClass(this.rootCSS+"-button-disabled"):this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled")):a=!0}i=t[e]}}).jBind(this);this.context.jAddEvent("touchdrag",t)},reflow:function(){var t=this.parent.jGetSize();0<t.height&&t.height>t.width?this.setOrientation("vertical"):this.setOrientation("horizontal"),t="vertical"==this.settings.orientation?"height":"width",this.context.jGetSize()[t]<=this.root.jGetSize()[t]?(this.root.jAddClass("no-buttons"),this.context.jSetCssProp("transition","").jGetSize(),this.context.jSetCssProp("transform","translate3d(0,0,0)"),this.buttons.prev.jAddClass(this.rootCSS+"-button-disabled"),this.buttons.next.jRemoveClass(this.rootCSS+"-button-disabled")):this.root.jRemoveClass("no-buttons"),this.selectedItem&&this.scroll(this.selectedItem,0)},setOrientation:function(t){"vertical"!==t&&"horizontal"!==t||t==this.settings.orientation||(this.root.jRemoveClass(this.rootCSS+"-"+this.settings.orientation),this.settings.orientation=t,this.root.jAddClass(this.rootCSS+"-"+this.settings.orientation),this.context.jSetCssProp("transition","none").jGetSize(),this.context.jSetCssProp("transform","").jSetCssProp("margin",""))}},t);function t(t,e){this.settings={cssPrefix:"magic",orientation:"horizontal",position:"bottom",size:{units:"px",width:"auto",height:"auto"},sides:["height","width"]},this.parent=t,this.root=null,this.wrapper=null,this.context=null,this.buttons={},this.items=[],this.selectedItem=null,this.scrollFX=null,this.resizeCallback=null,this.settings=u.extend(this.settings,e),this.rootCSS=this.settings.cssPrefix+"-thumbs",this.itemCSS=this.settings.cssPrefix+"-thumb",this.setupContent()}var p=m.$;"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var i=arguments[e];if(null!=i)for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}return t}),m.browser.cssTransform||(m.browser.cssTransform=m.normalizeCSS("transform").dashize());var o,s,n,a,h={zoomOn:{type:"string",enum:["click","hover"],default:"hover"},zoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","preview","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},zoomWidth:{oneOf:[{type:"string",enum:["auto"]},{type:"number",minimum:1}],default:"auto"},zoomHeight:{oneOf:[{type:"string",enum:["auto"]},{type:"number",minimum:1}],default:"auto"},zoomPosition:{type:"string",default:"right"},zoomDistance:{type:"number",minimum:0,default:15},zoomCaption:{oneOf:[{type:"string",enum:["bottom","top","off"],default:"off"},{type:"boolean",enum:[!1]}],default:"off"},expand:{oneOf:[{type:"string",enum:["window","fullscreen","off"]},{type:"boolean",enum:[!1]}],default:"window"},expandZoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},expandZoomOn:{type:"string",enum:["click","always"],default:"click"},expandCaption:{type:"boolean",default:!0},closeOnClickOutside:{type:"boolean",default:!0},history:{type:"boolean",default:!0},hint:{oneOf:[{type:"string",enum:["once","always","off"]},{type:"boolean",enum:[!1]}],default:"once"},smoothing:{type:"boolean",default:!0},upscale:{type:"boolean",default:!0},variableZoom:{type:"boolean",default:!1},lazyZoom:{type:"boolean",default:!1},autostart:{type:"boolean",default:!0},rightClick:{type:"boolean",default:!1},transitionEffect:{type:"boolean",default:!0},selectorTrigger:{type:"string",enum:["click","hover"],default:"click"},cssClass:{type:"string"},forceTouch:{type:"boolean",default:!1},textHoverZoomHint:{type:"string",default:"Hover to zoom"},textClickZoomHint:{type:"string",default:"Click to zoom"},textBtnNext:{type:"string",default:"Next"},textBtnPrev:{type:"string",default:"Previous"},textBtnClose:{type:"string",default:"Close"},textExpandHint:{type:"string",default:"Click to expand"}},r={zoomMode:{oneOf:[{type:"string",enum:["zoom","magnifier","off"],default:"zoom"},{type:"boolean",enum:[!1]}],default:"zoom"},expandZoomOn:{type:"string",enum:["click","always"],default:"click"},textExpandHint:{type:"string",default:"Tap or pinch to expand"},textHoverZoomHint:{type:"string",default:"Touch to zoom"},textClickZoomHint:{type:"string",default:"Double tap or pinch to zoom"}},d=["onZoomReady","onUpdate","onZoomIn","onZoomOut","onExpandOpen","onExpandClose"],l={},g=p([]),v=window.devicePixelRatio||1,f=!0,x=m.browser.features.perspective?"translate3d(":"translate(",w=m.browser.features.perspective?",0)":")",z=null,b=function(){return"mgctlbxN$MZ"+"p".toUpperCase()+" mgctlbxV$"+"v5.3.7".replace("v","")+" mgctlbxL$"+"t".toUpperCase()+(window.mgctlbx$Pltm&&"string"===m.jTypeOf(window.mgctlbx$Pltm)?" mgctlbxP$"+window.mgctlbx$Pltm.toLowerCase():"")};function j(t){var e=[],i=null;return t&&(i=p(t))&&(e=g.filter(function(t){return t.placeholder===i})),e.length?e[0]:null}function y(t){return Object.assign({},t,{type:t.type,pageX:t.pageX,pageY:t.pageY,screenX:t.screenX,screenY:t.screenY,clientX:t.clientX,clientY:t.clientY,cloned:!0})}function C(){var t=m.$A(arguments),e=t.shift(),i=l[e];if(i)for(var o=0;o<i.length;o++)i[o].apply(null,t)}function S(t,e,i,o,n){this.small={src:null,url:null,dppx:1,node:null,state:0,size:{width:0,height:0},loaded:!1},this.zoom={src:null,url:null,dppx:1,node:null,state:0,size:{width:0,height:0},loaded:!1},"object"===m.jTypeOf(t)?this.small=t:"string"===m.jTypeOf(t)&&(this.small.url=m.getAbsoluteURL(t)),"object"===m.jTypeOf(e)?this.zoom=e:"string"===m.jTypeOf(e)&&(this.zoom.url=m.getAbsoluteURL(e)),this.alt="",this.caption=i,this.options=o,this.origin=n,this.callback=null,this.link=null,this.node=null}S.prototype={parseNode:function(t,e,i){var o=t.byTag("img")[0];return i&&(this.small.node=o||m.$new("img").jAppendTo(t)),1<v&&(this.small.url=t.getAttribute("data-image-2x"),this.small.url&&(this.small.dppx=2),this.zoom.url=t.getAttribute("data-zoom-image-2x"),this.zoom.url&&(this.zoom.dppx=2)),this.small.src=t.getAttribute("data-image")||t.getAttribute("rev")||(o?o.currentSrc||o.getAttribute("src"):null),this.small.src&&(this.small.src=m.getAbsoluteURL(this.small.src)),this.small.url=this.small.url||this.small.src,this.small.url&&(this.small.url=m.getAbsoluteURL(this.small.url)),this.zoom.src=t.getAttribute("data-zoom-image")||t.getAttribute("href"),this.zoom.src&&(this.zoom.src=m.getAbsoluteURL(this.zoom.src)),this.zoom.url=this.zoom.url||this.zoom.src,this.zoom.url&&(this.zoom.url=m.getAbsoluteURL(this.zoom.url)),this.caption=t.getAttribute("data-caption")||t.getAttribute("title")||e,this.link=t.getAttribute("data-link"),this.origin=t,o&&(this.alt=o.getAttribute("alt")||""),this},loadImg:function(e){var i=null;1<arguments.length&&"function"===m.jTypeOf(arguments[1])&&(i=arguments[1]),0===this[e].state?(this[e].url&&this[e].node&&!this[e].node.getAttribute("src")&&!this[e].node.getAttribute("srcset")&&this[e].node.setAttribute("src",this[e].url),this[e].state=1,new m.ImageLoader(this[e].node||this[e].url,{oncomplete:p(function(t){this[e].loaded=!0,this[e].state=t.ready?2:-1,t.ready&&(0===this[e].size.width&&0===this[e].size.height&&(this[e].size=t.jGetSize()),this[e].node?(this[e].node.jSetCss({maxWidth:this[e].size.width,maxHeight:this[e].size.height}),this[e].node.currentSrc&&this[e].node.currentSrc!==this[e].node.src?this[e].url=this[e].node.currentSrc:m.getAbsoluteURL(this[e].node.getAttribute("src")||"")!==this[e].url&&this[e].node.setAttribute("src",this[e].url)):(this[e].node=p(t.img),this[e].node.getAttribute("style"),this[e].node.removeAttribute("style"),this[e].node.alt=this.alt,this[e].size.width/=this[e].dppx,this[e].size.height/=this[e].dppx)),this.onload(i)}).jBind(this)})):this[e].loaded&&this.onload(i)},loadSmall:function(){this.loadImg("small",arguments[0])},loadZoom:function(){this.loadImg("zoom",arguments[0])},load:function(){this.callback=null,0<arguments.length&&"function"===m.jTypeOf(arguments[0])&&(this.callback=arguments[0]),this.loadSmall(),this.loadZoom()},onload:function(t){t&&t.call(null,this),this.callback&&this.small.loaded&&this.zoom.loaded&&(this.callback.call(null,this),this.callback=null)},loaded:function(){return this.small.loaded&&this.zoom.loaded},ready:function(){return 2===this.small.state&&2===this.zoom.state},getURL:function(t){var e="small"===t?"zoom":"small";return!this[t].loaded||this[t].loaded&&2===this[t].state?this[t].url:!this[e].loaded||this[e].loaded&&2===this[e].state?this[e].url:null},getNode:function(t){var e="small"===t?"zoom":"small";return!this[t].loaded||this[t].loaded&&2===this[t].state?this[t].node:!this[e].loaded||this[e].loaded&&2===this[e].state?this[e].node:null},jGetSize:function(t){var e="small"===t?"zoom":"small";return!this[t].loaded||this[t].loaded&&2===this[t].state?this[t].size:!this[e].loaded||this[e].loaded&&2===this[e].state?this[e].size:{width:0,height:0}},setSize:function(t,e){this[t].size=e},getRatio:function(t){var e="small"===t?"zoom":"small";return!this[t].loaded||this[t].loaded&&2===this[t].state?this[t].dppx:!this[e].loaded||this[e].loaded&&2===this[e].state?this[e].dppx:1},setCurNode:function(t){this.node=this.getNode(t)}};function E(t,e){this.options=new m.Options(h),this.option=p(function(){return 1<arguments.length?this.set(arguments[0],arguments[1]):this.get(arguments[0])}).jBind(this.options),this.touchOptions=new m.Options(r),this.additionalImages=[],this.image=null,this.primaryImage=null,this.placeholder=p(t).jAddEvent("dragstart selectstart click",function(t){t.stop()}),this.id=null,this.node=null,this.stubNode=null,this.originalImg=null,this.originalImgSrc=null,this.originalTitle=null,this.normalSize={width:0,height:0},this.size={width:0,height:0},this.zoomSize={width:0,height:0},this.zoomSizeOrigin={width:0,height:0},this.boundaries={top:0,left:0,bottom:0,right:0},this.ready=!1,this.expanded=!1,this.activateTimer=null,this.resizeTimer=null,this.resizeCallback=p(function(){this.expanded&&(a&&this.expandBox.jSetCss({height:window.innerHeight,top:Math.abs(a.getBoundingClientRect().top)}),this.image.node.jSetCss({"max-height":Math.min(this.image.jGetSize("zoom").height,this.expandMaxHeight())}),this.image.node.jSetCss({"max-width":Math.min(this.image.jGetSize("zoom").width,this.expandMaxWidth())})),this.reflowZoom(arguments[0])}).jBind(this),this.onResize=p(function(t){clearTimeout(this.resizeTimer),this.resizeTimer=p(this.resizeCallback).jDelay(10,"scroll"===t.type)}).jBindAsEvent(this),this.onHistoryStateChange=p(function(t){!t.state&&this.expanded&&this.close(),t.state&&t.state.mzId===this.id&&!this.expanded&&this.expand()}).jBindAsEvent(this),b&&(s.append(m.$new("div",{},{display:"none",visibility:"hidden"}).append(document.createTextNode(b))),b=void 0),this.lens=null,this.zoomBox=null,this.hint=null,this.hintMessage=null,this.hintRuns=0,this.mobileZoomHint=!0,this.loadingBox=null,this.loadTimer=null,this.thumb=null,this.expandBox=null,this.expandBg=null,this.expandCaption=null,this.expandStage=null,this.expandImageStage=null,this.expandFigure=null,this.navControlsLayer=null,this.expandNav=null,this.expandThumbs=null,this.expandGallery=[],this.buttons={},this.startAttempts=0,this.startTimer=null,this.start(e)}return E.prototype={loadOptions:function(t){switch(this.options.fromJSON(window.mzOptions||{}),this.options.fromString(this.placeholder.getAttribute("data-options")||""),m.browser.touchScreen||this.option("forceTouch",!1),(m.browser.mobile||this.option("forceTouch"))&&(this.options.fromJSON(this.touchOptions.getJSON()),this.options.fromJSON(window.mzMobileOptions||{}),this.options.fromString(this.placeholder.getAttribute("data-mobile-options")||"")),"string"===m.jTypeOf(t)?this.options.fromString(t||""):this.options.fromJSON(t||{}),this.option("cssClass")&&this.option("cssClass",this.option("cssClass").replace(","," ")),!1===this.option("zoomCaption")&&this.option("zoomCaption","off"),!1===this.option("hint")&&this.option("hint","off"),this.option("hint")){case"off":this.hintRuns=0;break;case"always":this.hintRuns=1/0;break;case"once":default:this.hintRuns=2}"off"===this.option("zoomMode")&&this.option("zoomMode",!1),"off"===this.option("expand")&&this.option("expand",!1),"off"===this.option("expandZoomMode")&&this.option("expandZoomMode",!1),m.browser.mobile&&"zoom"===this.option("zoomMode")&&"inner"===this.option("zoomPosition")&&(this.option("expand")?this.option("zoomMode",!1):this.option("zoomOn","click"))},start:function(t){var e=this;if(this.startAttempts<1){if(this.loadOptions(t),f&&!this.option("autostart"))return;if(this.originalImg=this.placeholder.querySelector("img"),this.originalImgSrc=this.originalImg?this.originalImg.getAttribute("src"):null,this.originalTitle=p(this.placeholder).getAttribute("title"),p(this.placeholder).removeAttribute("title"),this.originalImg&&"PICTURE"===this.originalImg.parentNode.tagName){this.originalImgSrc=null;var i=m.$new("div").jAddClass("magic-temporary-img").jAppendTo(document.body),o=this.originalImg.parentNode.cloneNode(!0);o.getAttribute("style"),o.removeAttribute("style");var n=o.querySelector("img");return n.getAttribute("style"),n.removeAttribute("style"),p(n).jAddEvent("load",function(){e.size=p(n).jGetSize(),i.kill();var t=e.originalImg.cloneNode(!1);p(t).jSetCss({maxWidth:e.size.width,maxHeight:e.size.height}).setAttribute("src",e.originalImg.currentSrc||e.originalImg.src),e.originalImg=e.placeholder.replaceChild(t,e.originalImg.parentNode),e.start()}),i.append(o),void++this.startAttempts}}(o=(new S).parseNode(this.placeholder,this.originalTitle,!0)).setSize("small",this.size),o.small.url?(this.primaryImage=o,this.image=this.primaryImage,function(t){var e,i,o=t,n=[];try{for(;i=o.tagName,/^[A-Za-z]*$/.test(i)&&((e=o.getAttribute("id"))&&/^[A-Za-z][-A-Za-z0-9_]*/.test(e)&&(i+="#"+e),n.push(i)),o=o.parentNode,o&&o!==document.documentElement;);n=n.reverse(),m.addCSS(n.join(" ")+"> .mz-figure > img",{transition:"none",transform:"none"},"mz-runtime-css",!0),m.addCSS(n.join(" ")+":not(.mz-no-rt-width-css)> .mz-figure:not(.mz-no-rt-width-css) > img",{width:"100% !important;"},"mz-runtime-css",!0)}catch(t){}}(this.placeholder),this.id=this.placeholder.getAttribute("id")||"mz-"+Math.floor(Math.random()*m.now()),this.placeholder.setAttribute("id",this.id),this.node=m.$new("figure").jAddClass("mz-figure"),this.node.enclose(this.image.small.node).jAddClass(this.option("cssClass")),!0!==this.option("rightClick")&&this.node.jAddEvent("contextmenu",function(t){return t.stop(),!1}),this.node.jAddClass("mz-"+this.option("zoomOn")+"-zoom"),this.option("expand")||this.node.jAddClass("mz-no-expand"),this.lens={node:m.$new("div",{class:"mz-lens"},{top:0}).jAppendTo(this.node),image:m.$new("img",{src:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},{position:"absolute",top:0,left:0}),width:0,height:0,pos:{x:0,y:0},spos:{x:0,y:0},size:{width:0,height:0},border:{x:0,y:0},dx:0,dy:0,innertouch:!1,hide:function(){m.browser.features.transform?this.node.jSetCss({transform:"translate(-10000px, -10000px)"}):this.node.jSetCss({top:-1e4})}},this.lens.hide(),this.lens.node.append(this.lens.image),this.zoomBox={node:m.$new("div",{class:"mz-zoom-window"},{top:-1e5}).jAddClass(this.option("cssClass")).jAppendTo(s),image:m.$new("img",{src:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},{position:"absolute"}),aspectRatio:0,width:0,height:0,innerWidth:0,innerHeight:0,size:{width:"auto",wunits:"px",height:"auto",hunits:"px"},mode:this.option("zoomMode"),position:this.option("zoomPosition"),trigger:this.option("zoomOn"),custom:!1,active:!1,activating:!1,enabled:!1,enable:p(function(){this.zoomBox.enabled=!1!==arguments[0],this.node[this.zoomBox.enabled?"jRemoveClass":"jAddClass"]("mz-no-zoom")}).jBind(this),hide:p(function(){var t=p(this.node).jFetch("cr");this.zoomBox.node.jRemoveEvent("transitionend"),this.zoomBox.node.jSetCss({top:-1e5}).jAppendTo(s),this.zoomBox.node.jRemoveClass("mz-deactivating mz-p-"+("zoom"===this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode)),!this.expanded&&t&&t.jRemove(),this.zoomBox.image.getAttribute("style"),this.zoomBox.image.removeAttribute("style")}).jBind(this),setMode:p(function(t){this.node[!1===t?"jAddClass":"jRemoveClass"]("mz-no-zoom"),this.node["magnifier"===t?"jAddClass":"jRemoveClass"]("mz-magnifier-zoom"),this.zoomBox.node["magnifier"===t?"jAddClass":"jRemoveClass"]("mz-magnifier"),this.zoomBox.node["preview"===t?"jAddClass":"jRemoveClass"]("mz-preview"),"zoom"!==t&&(this.node.jRemoveClass("mz-inner-zoom"),this.zoomBox.node.jRemoveClass("mz-inner")),!1===(this.zoomBox.mode=t)&&this.zoomBox.enable(!1)}).jBind(this)},this.zoomBox.node.append(this.zoomBox.image),this.zoomBox.setMode(this.option("zoomMode")),this.zoomBox.image.removeAttribute("width"),this.zoomBox.image.removeAttribute("height"),(o=(""+this.option("zoomWidth")).match(/^([0-9]+)?(px|%)?$/))&&(this.zoomBox.size.wunits=o[2]||"px",this.zoomBox.size.width=parseFloat(o[1])||"auto"),(o=(""+this.option("zoomHeight")).match(/^([0-9]+)?(px|%)?$/))&&(this.zoomBox.size.hunits=o[2]||"px",this.zoomBox.size.height=parseFloat(o[1])||"auto"),"magnifier"===this.zoomBox.mode?(this.node.jAddClass("mz-magnifier-zoom"),this.zoomBox.node.jAddClass("mz-magnifier"),"auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="%",this.zoomBox.size.width=70),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="%")):(this.option("zoom-position").match(/^#/)&&((this.zoomBox.custom=p(this.option("zoom-position").replace(/^#/,"")))?50<p(this.zoomBox.custom).jGetSize().height&&("auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="%",this.zoomBox.size.width=100),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="%",this.zoomBox.size.height=100)):this.option("zoom-position","right")),"preview"===this.zoomBox.mode&&("auto"===this.zoomBox.size.width&&(this.zoomBox.size.wunits="px"),"auto"===this.zoomBox.size.height&&(this.zoomBox.size.hunits="px")),"zoom"===this.zoomBox.mode&&("auto"!==this.zoomBox.size.width&&"inner"!==this.option("zoom-position")||(this.zoomBox.size.wunits="%",this.zoomBox.size.width=100),"auto"!==this.zoomBox.size.height&&"inner"!==this.option("zoom-position")||(this.zoomBox.size.hunits="%",this.zoomBox.size.height=100)),"inner"===this.option("zoom-position")&&this.node.jAddClass("mz-inner-zoom")),this.zoomBox.position=this.zoomBox.custom?"custom":this.option("zoom-position"),this.lens.border.x=parseFloat(this.lens.node.jGetCss("border-left-width")||"0"),this.lens.border.y=parseFloat(this.lens.node.jGetCss("border-top-width")||"0"),this.image.loadSmall(function(){2===this.image.small.state&&(this.image.setCurNode("small"),this.size=this.image.node.jGetSize(),this.registerEvents(),(this.ready=!0)===this.option("lazyZoom")&&(C("onZoomReady",this.id),m.browser.mobile?this.reflowZoom():this.showHint()))}.jBind(this)),!0===this.option("lazyZoom")&&"always"!==this.option("zoomOn")||(this.image.load(p(function(t){this.setupZoom(t,!0)}).jBind(this)),this.loadTimer=p(this.showLoading).jBind(this).jDelay(400)),this.setupSelectors(),this.setupButtons()):++this.startAttempts<=600&&(this.startTimer=setTimeout(function(){e.start()},100))},stop:function(){clearTimeout(this.startTimer),this.unregisterEvents(),this.zoomBox&&this.zoomBox.node.kill(),this.expandThumbs&&(this.expandThumbs.stop(),this.expandThumbs=null),this.expandBox&&this.expandBox.kill(),this.expanded&&p(m.browser.getDoc()).jSetCss({overflow:""}),p(this.additionalImages).jEach(function(t){p(t.origin).jRemoveClass("mz-thumb-selected").jRemoveClass(this.option("cssClass")||"mz-$dummy-css-class-to-jRemove$")},this),this.originalImg&&(this.placeholder.append(this.originalImg),this.originalImgSrc&&this.originalImg.setAttribute("src",this.originalImgSrc)),this.originalTitle&&this.placeholder.setAttribute("title",this.originalTitle),this.node&&this.node.kill()},setupZoom:function(t,e){var i=this.image;if(2!==t.zoom.state)return this.image=t,this.ready=!0,void this.zoomBox.enable(!1);this.image=t,this.image.setCurNode(this.expanded?"zoom":"small"),this.zoomBox.image.src=this.image.getURL("zoom"),this.zoomBox.image.alt=this.image.alt,this.zoomBox.node.jRemoveClass("mz-preview"),this.zoomBox.image.getAttribute("style"),this.zoomBox.image.removeAttribute("style"),this.zoomBox.node.jGetSize(),setTimeout(p(function(){var t=this.zoomBox.image.jGetSize();this.zoomSizeOrigin=this.image.jGetSize("zoom"),1<t.width*t.height&&t.width*t.height<this.zoomSizeOrigin.width*this.zoomSizeOrigin.height&&(this.zoomSizeOrigin=t),this.zoomSize=m.detach(this.zoomSizeOrigin),"preview"===this.zoomBox.mode&&this.zoomBox.node.jAddClass("mz-preview"),this.setCaption(),this.lens.image.src=this.image.node.currentSrc||this.image.node.src,this.lens.image.alt=this.image.alt,this.zoomBox.enable(this.zoomBox.mode&&!(this.expanded&&"preview"===this.zoomBox.mode)),this.ready=!0,this.activateTimer=null,this.resizeCallback(),this.node.jAddClass("mz-ready"),this.hideLoading(),i!==this.image?(C("onUpdate",this.id,i.origin,this.image.origin),this.nextImage&&(t=this.nextImage,this.nextImage=null,this.update(t.image,t.onswipe))):e&&C("onZoomReady",this.id),this.initEvent?this.node.jCallEvent(this.initEvent.type,this.initEvent):this.expanded&&"always"===this.option("expandZoomOn")?this.activate():e&&this.showHint()}).jBind(this),256)},setupSelectors:function(){var e=this.id,i=new RegExp("zoom\\-id(\\s+)?:(\\s+)?"+e+"($|;)"),t=m.browser.features.query?(t=m.$A(document.querySelectorAll('[data-zoom-id="'+this.id+'"]')),p(t).concat(m.$A(document.querySelectorAll('[rel*="zoom-id"]')).filter(function(t){return i.test(t.getAttribute("rel")||"")}))):m.$A(document.getElementsByTagName("A")).filter(function(t){return e===t.getAttribute("data-zoom-id")||i.test(t.getAttribute("rel")||"")});p(t).jEach(function(t){var e,i;p(t).jAddEvent("click",function(t){t.stopDefaults()}),e=(new S).parseNode(t,this.originalTitle),(this.image.zoom.src.has(e.zoom.url)||this.image.zoom.url.has(e.zoom.url))&&(this.image.small.src.has(e.small.url)||this.image.small.url.has(e.small.url))&&(p(e.origin).jAddClass("mz-thumb-selected"),(e=this.image).origin=t),!e.link&&this.image.link&&(e.link=this.image.link),i=p(function(){this.update(e)}).jBind(this),p(t).jAddEvent("mousedown",function(t){"stopImmediatePropagation"in t&&t.stopImmediatePropagation()},5),p(t).jAddEvent("tap "+("hover"===this.option("selectorTrigger")?"mouseover mouseout":"btnclick"),p(function(t,e){this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=!1,"mouseover"===t.type?this.updateTimer=p(i).jDelay(e):"tap"!==t.type&&"btnclick"!==t.type||i()}).jBindAsEvent(this,60)).jAddClass(this.option("cssClass")).jAddClass("mz-thumb"),!0!==this.option("lazyZoom")&&(e.loadSmall(),e.loadZoom()),this.additionalImages.push(e)},this)},update:function(t,h){if(this.ready){if(!t||t===this.image)return!1;this.deactivate(null,!0),this.ready=!1,this.node.jRemoveClass("mz-ready"),this.loadTimer=p(this.showLoading).jBind(this).jDelay(400);var e=p(function(t){var e,i,o,n,s,a=m.browser.ieMode<10?"jGetSize":"getBoundingClientRect";if(this.hideLoading(),t.setCurNode("small"),!t.node)return this.ready=!0,void this.node.jAddClass("mz-ready");this.setActiveThumb(t),e=this.image.node[a](),this.expanded&&(t.setCurNode("zoom"),o=m.$new("div").jAddClass("mz-expand-bg"),m.browser.features.cssFilters||m.browser.ieMode<10?o.append(m.$new("img",{srcset:t.getURL("zoom")+" "+t.getRatio("zoom")+"x",src:t.getURL("zoom"),alt:t.alt}).jSetCss({opacity:0})):o.append(new m.SVGImage(t.node).blur(20).getNode().jSetCss({opacity:0})),p(o).jSetCss({"z-index":-99}).jAppendTo(this.expandBox)),this.expanded&&"zoom"===this.zoomBox.mode&&"always"===this.option("expandZoomOn")?(p(t.node).jSetCss({opacity:0}).jAppendTo(this.node),i=e,n=[t.node,this.image.node],s=[{opacity:[0,1]},{opacity:[1,0]}],p(t.node).jSetCss({"max-width":Math.min(t.jGetSize("zoom").width,this.expandMaxWidth()),"max-height":Math.min(t.jGetSize("zoom").height,this.expandMaxHeight())})):(this.node.jSetCss({height:this.node[a]().height}),this.image.node.jSetCss({position:"absolute",top:0,left:0,bottom:0,right:0,width:"100%",height:"100%","max-width":"","max-height":""}),p(t.node).jSetCss({"max-width":Math.min(t.jGetSize(this.expanded?"zoom":"small").width,this.expanded?this.expandMaxWidth():1/0),"max-height":Math.min(t.jGetSize(this.expanded?"zoom":"small").height,this.expanded?this.expandMaxHeight():1/0),position:"relative",top:0,left:0,opacity:0,transform:""}).jAppendTo(this.node),i=p(t.node)[a](),h||p(t.node).jSetCss({"min-width":e.width,height:e.height,"max-width":e.width,"max-height":""}),this.node.jSetCss({height:"",overflow:""}).jGetSize(),p(t.node).jGetSize(),n=[t.node,this.image.node],s=[m.extend({opacity:[0,1]},h?{scale:[.6,1]}:{"min-width":[e.width,i.width],"max-width":[e.width,i.width],height:[e.height,i.height]}),{opacity:[1,0]}]),this.expanded&&this.expandBg.firstChild&&o.firstChild&&(a=p(this.expandBg.firstChild).jGetCss("opacity"),s=m.browser.gecko?(n=n.concat([o.firstChild]),s.concat([{opacity:[1e-4,a]}])):(n=n.concat([o.firstChild,this.expandBg.firstChild]),s.concat([{opacity:[1e-4,a]},{opacity:[a,1e-4]}]))),new m.PFX(n,{duration:h||this.option("transitionEffect")?h?160:350:0,transition:h?"cubic-bezier(0.175, 0.885, 0.320, 1)":e.width===i.width?"linear":"cubic-bezier(0.25, .1, .1, 1)",onComplete:p(function(){this.image.node.jRemove().getAttribute("style"),this.image.node.removeAttribute("style"),p(t.node).jSetCss(this.expanded?{width:"auto",height:"auto"}:{width:"",height:""}).jSetCss({"min-width":"","min-height":"",opacity:"","max-width":Math.min(t.jGetSize(this.expanded?"zoom":"small").width,this.expanded?this.expandMaxWidth():1/0),"max-height":Math.min(t.jGetSize(this.expanded?"zoom":"small").height,this.expanded?this.expandMaxHeight():1/0)}),this.expanded&&(this.expandBg.jRemove(),this.expandBg=void 0,this.expandBg=o.jSetCssProp("z-index",-100),p(this.expandBg.firstChild).jSetCss({opacity:""}),this.expandCaption&&(t.caption?t.link?this.expandCaption.changeContent("").append(m.$new("a",{href:t.link}).jAddEvent("tap btnclick",this.openLink.jBind(this)).changeContent(t.caption)):this.expandCaption.changeContent(t.caption).jAddClass("mz-show"):this.expandCaption.jRemoveClass("mz-show"))),this.setupZoom(t)}).jBind(this),onBeforeRender:p(function(t,e){void 0!==t.scale&&e.jSetCssProp("transform","scale("+t.scale+")")})}).start(s)}).jBind(this);this.expanded?t.load(e):t.loadSmall(e)}else this.nextImage={image:t,onswipe:h}},setActiveThumb:function(e){var i=!1;p(this.additionalImages).jEach(function(t){p(t.origin).jRemoveClass("mz-thumb-selected"),t===e&&(i=!0)}),i&&e.origin&&p(e.origin).jAddClass("mz-thumb-selected"),this.expandThumbs&&this.expandThumbs.selectItem(e.selector)},setCaption:function(t){this.image.caption&&"off"!==this.option("zoomCaption")&&"magnifier"!==this.zoomBox.mode&&(this.zoomBox.caption||(this.zoomBox.caption=m.$new("div",{class:"mz-caption"}).jAppendTo(this.zoomBox.node.jAddClass("caption-"+this.option("zoomCaption")))),this.zoomBox.caption.changeContent(this.image.caption))},showHint:function(t,e,i){if(!this.expanded){if(this.hintRuns<=0)return;!0!==i&&this.hintRuns--}null==e&&(this.zoomBox.active||this.zoomBox.activating||!this.option("zoomMode")||!this.zoomBox.enabled&&this.image.loaded()||m.browser.mobile&&this.option("expand")&&"zoom"===this.zoomBox.mode&&"inner"===this.zoomBox.position?e=this.option("expand")?this.option("textExpandHint"):"":"hover"===this.zoomBox.trigger?e=this.option("textHoverZoomHint"):"click"===this.zoomBox.trigger&&(e=this.option("textClickZoomHint"))),e?(i=this.node,this.hint?p(this.hintMessage).changeContent(e):(this.hint=m.$new("div",{class:"mz-hint"}),this.hintMessage=m.$new("span",{class:"mz-hint-message"}).append(document.createTextNode(e)).jAppendTo(this.hint),p(this.hint).jAppendTo(this.node)),this.hint.jSetCss({"transition-delay":""}).jRemoveClass("mz-hint-hidden"),this.expanded?i=this.expandFigure:(this.zoomBox.active||this.zoomBox.activating)&&"magnifier"!==this.zoomBox.mode&&"inner"===this.zoomBox.position&&(i=this.zoomBox.node),!0===t&&setTimeout(p(function(){this.hint.jAddClass("mz-hint-hidden")}).jBind(this),16),this.hint.jAppendTo(i)):this.hideHint()},hideHint:function(){this.hint&&this.hint.jSetCss({"transition-delay":"0ms"}).jAddClass("mz-hint-hidden")},showLoading:function(){this.loadingBox||(this.loadingBox=m.$new("div",{class:"mz-loading"}),this.node.append(this.loadingBox),this.loadingBox.jGetSize()),this.loadingBox.jAddClass("shown")},hideLoading:function(){clearTimeout(this.loadTimer),this.loadTimer=null,this.loadingBox&&p(this.loadingBox).jRemoveClass("shown")},setSize:function(t,e){var i=m.detach(this.zoomBox.size),o=!this.expanded&&this.zoomBox.custom?p(this.zoomBox.custom).jGetSize():{width:0,height:0},n=this.size,s={x:0,y:0};e=e||this.zoomBox.position,this.normalSize=this.image.node.jGetSize(),this.size=this.image.node.jGetSize(),this.boundaries=this.image.node.getBoundingClientRect(),o.height||(o=this.size),!1!==this.option("upscale")&&!1!==this.zoomBox.mode&&"preview"!==this.zoomBox.mode||(t=!1),"preview"===this.zoomBox.mode&&("auto"===i.width&&(i.width=this.zoomSizeOrigin.width),"auto"===i.height&&(i.height=this.zoomSizeOrigin.height)),this.expanded&&"magnifier"===this.zoomBox.mode&&(i.width=70,i.height="auto"),"magnifier"===this.zoomBox.mode&&"auto"===i.height?(this.zoomBox.width=parseFloat(i.width/100)*Math.min(o.width,o.height),this.zoomBox.height=this.zoomBox.width):"zoom"===this.zoomBox.mode&&"inner"===e?(this.size=this.node.jGetSize(),o=this.size,this.boundaries=this.node.getBoundingClientRect(),this.zoomBox.width=o.width,this.zoomBox.height=o.height):(this.zoomBox.width="%"===i.wunits?parseFloat(i.width/100)*o.width:parseInt(i.width),this.zoomBox.height="%"===i.hunits?parseFloat(i.height/100)*o.height:parseInt(i.height)),"preview"===this.zoomBox.mode&&(i=Math.min(Math.min(this.zoomBox.width/this.zoomSizeOrigin.width,this.zoomBox.height/this.zoomSizeOrigin.height),1),this.zoomBox.width=this.zoomSizeOrigin.width*i,this.zoomBox.height=this.zoomSizeOrigin.height*i),this.zoomBox.width=Math.ceil(this.zoomBox.width),this.zoomBox.height=Math.ceil(this.zoomBox.height),this.zoomBox.aspectRatio=this.zoomBox.width/this.zoomBox.height,this.zoomBox.node.jSetCss({width:this.zoomBox.width,height:this.zoomBox.height}),t&&(o=(this.expanded?this.expandBox:this.zoomBox.node).jGetSize(),!this.expanded&&.8<this.normalSize.width*this.normalSize.height/(this.zoomSizeOrigin.width*this.zoomSizeOrigin.height)?(this.zoomSize.width=1.5*this.zoomSizeOrigin.width,this.zoomSize.height=1.5*this.zoomSizeOrigin.height):this.zoomSize=m.detach(this.zoomSizeOrigin)),!1===this.zoomBox.mode||this.zoomBox.active||this.expanded&&"always"===this.option("expandZoomOn")||(.8<this.normalSize.width*this.normalSize.height/(this.zoomSize.width*this.zoomSize.height)?(this.zoomSize=m.detach(this.zoomSizeOrigin),this.zoomBox.enable(!1)):this.zoomBox.enable(!0)),this.zoomBox.image.jSetCss({width:this.zoomSize.width,height:this.zoomSize.height}),this.zoomSize.maxWidth=this.zoomSize.width,this.zoomSize.maxHeight=this.zoomSize.height,o=this.zoomBox.node.getInnerSize(),this.zoomBox.innerWidth=Math.ceil(o.width),this.zoomBox.innerHeight=Math.ceil(o.height),this.lens.width=Math.ceil(this.zoomBox.innerWidth/(this.zoomSize.width/this.size.width)),this.lens.height=Math.ceil(this.zoomBox.innerHeight/(this.zoomSize.height/this.size.height)),this.lens.node.jSetCss({width:this.lens.width,height:this.lens.height}),this.lens.image.jSetCss(this.size),m.extend(this.lens,this.lens.node.jGetSize()),this.zoomBox.active&&(clearTimeout(this.moveTimer),this.moveTimer=null,this.lens.innertouch?(this.lens.pos.x*=this.size.width/n.width,this.lens.pos.y*=this.size.height/n.height,s.x=this.lens.spos.x,s.y=this.lens.spos.y):(s.x=this.boundaries.left+this.lens.width/2+this.lens.pos.x*(this.size.width/n.width),s.y=this.boundaries.top+this.lens.height/2+this.lens.pos.y*(this.size.height/n.height)),this.animate(null,s))},reflowZoom:function(t){var e,i,o,n,s,a,h,r=p(this.node).jFetch("cr");if(s=5,a=p(window).jGetSize(),h=p(window).jGetScroll(),o={left:s=s||0,right:a.width-s,top:s,bottom:a.height-s,x:h.x,y:h.y},this.zoomBox.position,n=this.expanded?"inner":this.zoomBox.custom?"custom":this.option("zoom-position"),h=this.expanded&&"zoom"===this.zoomBox.mode?this.expandImageStage:document.body,this.expanded&&(o.y=0,o.x=0),t||this.setSize(!0,n),e=this.boundaries.top,"magnifier"!==this.zoomBox.mode){if(t)return void this.setSize(!1);switch(n){case"inner":case"custom":i=e=0;break;case"top":e=this.boundaries.top-this.zoomBox.height-this.option("zoom-distance"),o.top>e&&(e=this.boundaries.bottom+this.option("zoom-distance"),n="bottom"),i=this.boundaries.left;break;case"bottom":e=this.boundaries.bottom+this.option("zoom-distance"),o.bottom<e+this.zoomBox.height&&(e=this.boundaries.top-this.zoomBox.height-this.option("zoom-distance"),n="top"),i=this.boundaries.left;break;case"left":i=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance"),o.left>i&&o.right>=this.boundaries.right+this.option("zoom-distance")+this.zoomBox.width&&(i=this.boundaries.right+this.option("zoom-distance"),n="right");break;case"right":default:i=this.boundaries.right+this.option("zoom-distance"),o.right<i+this.zoomBox.width&&o.left<=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance")&&(i=this.boundaries.left-this.zoomBox.width-this.option("zoom-distance"),n="left")}switch(this.option("zoom-position")){case"top":case"bottom":(o.top>e||o.bottom<e+this.zoomBox.height)&&(n="inner");break;case"left":case"right":(o.left>i||o.right<i+this.zoomBox.width)&&(n="inner")}if(this.zoomBox.position=n,!this.zoomBox.activating&&!this.zoomBox.active)return void(m.browser.mobile&&!this.expanded&&("zoom"===this.zoomBox.mode||!1===this.zoomBox.mode&&this.option("expand"))&&(this.option("expand")?this.zoomBox.enable("inner"!==n):"click"!==this.option("zoomOn")&&(this.zoomBox.trigger="inner"===n?"click":this.option("zoomOn"),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),this.registerActivateEvent("click"===this.zoomBox.trigger),this.registerDeactivateEvent("click"===this.zoomBox.trigger&&!this.option("expand"))),this.showHint(!1,null,!(this.option("lazyZoom")&&this.image.loaded()))));if(this.setSize(!1),t)return;"custom"===n&&(h=this.zoomBox.custom,o.y=0,o.x=0),"inner"===n?("preview"!==this.zoomBox.mode&&(this.zoomBox.node.jAddClass("mz-inner"),this.node.jAddClass("mz-inner-zoom")),this.lens.hide(),e=this.boundaries.top+o.y,i=this.boundaries.left+o.x,i=e=0,this.expanded||(h=this.node)):(e+=o.y,i+=o.x,this.node.jRemoveClass("mz-inner-zoom"),this.zoomBox.node.jRemoveClass("mz-inner")),this.zoomBox.node.jSetCss({top:e,left:i})}else this.setSize(!1),h=this.node,!m.browser.mobile||this.expanded||this.zoomBox.activating||this.zoomBox.active||this.showHint(!1,null,!(this.option("lazyZoom")&&this.image.loaded()));this.zoomBox.node[this.expanded?"jAddClass":"jRemoveClass"]("mz-expanded"),!this.expanded&&r&&r.jAppendTo(("zoom"===this.zoomBox.mode&&"inner"===n?this.zoomBox:this).node,(Math.floor(101*Math.random())+1)%2?"top":"bottom"),this.zoomBox.node.jAppendTo(h)},changeZoomLevel:function(t){var e,i,o,n=!1,s=t.isMouse?5:3/54;if(this.zoomBox.active){if(p(t).stop(),s=(100+s*Math.abs(t.deltaY))/100,t.deltaY<0&&(s=1/s),"magnifier"===this.zoomBox.mode)i=Math.max(100,Math.round(this.zoomBox.width*s)),o=(i=Math.min(i,.9*this.size.width))/this.zoomBox.aspectRatio,this.zoomBox.width=Math.ceil(i),this.zoomBox.height=Math.ceil(o),this.zoomBox.node.jSetCss({width:this.zoomBox.width,height:this.zoomBox.height}),e=this.zoomBox.node.getInnerSize(),this.zoomBox.innerWidth=Math.ceil(e.width),this.zoomBox.innerHeight=Math.ceil(e.height),n=!0;else{if(this.expanded||"zoom"!==this.zoomBox.mode)return;i=Math.max(this.size.width,Math.round(this.zoomSize.width*s)),o=(i=Math.min(i,this.zoomSize.maxWidth))/(this.zoomSize.maxWidth/this.zoomSize.maxHeight),this.zoomSize.width=Math.ceil(i),this.zoomSize.height=Math.ceil(o)}o=p(window).jGetScroll(),this.lens.width=this.zoomBox.innerWidth/(this.zoomSize.width/this.size.width),this.lens.height=this.zoomBox.innerHeight/(this.zoomSize.height/this.size.height),this.lens.node.jSetCss({width:this.lens.width,height:this.lens.height}),m.extend(this.lens,this.lens.node.jGetSize()),this.zoomBox.active&&(clearTimeout(this.moveTimer),this.moveTimer=null,n&&(this.moveTimer=!0),this.animate(null,{x:t.x-o.x,y:t.y-o.y}),n&&(this.moveTimer=null))}},registerActivateEvent:function(t){var e,i=t?"dbltap btnclick":"touchstart"+(window.navigator.pointerEnabled?" pointerdown":window.navigator.msPointerEnabled?" MSPointerDown":"")+(window.navigator.pointerEnabled?" pointermove":window.navigator.msPointerEnabled?" MSPointerMove":" mousemove"),t=this.node.jFetch("mz:handlers:activate:fn",p(t?this.activate:function(t){t.isTouchEvent()&&!t.isPrimaryTouch()||t&&"touch"===t.pointerType&&"pointerdown"!==t.type||(e=m.browser.ieMode<9?m.extend({},t):t,this.activateTimer||(clearTimeout(this.activateTimer),this.activateTimer=setTimeout(p(function(){this.activate(e)}).jBind(this),120)))}).jBindAsEvent(this));this.node.jStore("mz:handlers:activate:event",i).jAddEvent(i,t,10)},unregisterActivateEvent:function(){var t=this.node.jFetch("mz:handlers:activate:event"),e=this.node.jFetch("mz:handlers:activate:fn");this.node.jRemoveEvent(t,e),this.node.jDel("mz:handlers:activate:fn")},registerDeactivateEvent:function(t){var e="touchend";window.navigator.pointerEnabled?e+=" pointerup pointerout pointermove":window.navigator.msPointerEnabled?e+=" MSPointerUp MSPointerOut MSPointerMove":e+=" mouseout mousemove",t&&(this.expanded||m.browser.mobile?e="dbltap btnclick":e+=" dbltap btnclick");t=this.node.jFetch("mz:handlers:deactivate:fn",p(function(t){var e;t.isTouchEvent()&&!t.isPrimaryTouch()||t&&"pointerup"===t.type&&"touch"!==t.pointerType||(!t||"pointermove"!==t.type&&"MSPointerMove"!==t.type&&"mousemove"!==t.type?this.zoomBox.node===t.getRelated()||("inner"===this.zoomBox.position||"magnifier"===this.zoomBox.mode)&&this.zoomBox.node.hasChild(t.getRelated())||this.node.hasChild(t.getRelated())||this.deactivate(t):this.ready&&this.zoomBox.enabled&&this.zoomBox.active&&(((e=t.getClientXY()).x<this.boundaries.left||e.x>this.boundaries.right||e.y<this.boundaries.top||e.y>this.boundaries.bottom)&&this.deactivate(t)))}).jBindAsEvent(this));this.node.jStore("mz:handlers:deactivate:event",e).jAddEvent(e,t,20)},unregisterDeactivateEvent:function(){var t=this.node.jFetch("mz:handlers:deactivate:event"),e=this.node.jFetch("mz:handlers:deactivate:fn");this.node.jRemoveEvent(t,e),this.node.jDel("mz:handlers:deactivate:fn")},registerAnimateEvent:function(){var t="touchmove";"android"!==m.browser.platform&&(window.navigator.pointerEnabled?t+=" pointermove":window.navigator.msPointerEnabled?t+=" MSPointerMove":t+=" mousemove");var e=this.node.jFetch("mz:handlers:animate:fn",p(this.animate).jBindAsEvent(this));this.node.jStore("mz:handlers:animate:event",t).jAddEvent(t,e)},unregisterAnimateEvent:function(){var t=this.node.jFetch("mz:handlers:animate:event"),e=this.node.jFetch("mz:handlers:animate:fn");this.node.jRemoveEvent(t,e)},registerEvents:function(){this.moveBind=this.move.jBind(this),this.node.jAddEvent(["touchstart",window.navigator.pointerEnabled?"pointerdown":"MSPointerDown"],p(function(t){m.browser.androidBrowser&&this.option("zoomMode")&&"click"!==this.option("zoomOn")&&"touchstart"===t.type&&(t.stopDefaults(),m.browser.gecko&&t.stopDistribution()),this.zoomBox.active&&"inner"===this.zoomBox.position&&t.isPrimaryTouch()&&(this.lens.spos=t.getClientXY())}).jBindAsEvent(this),10),this.node.jAddEvent(["touchend",window.navigator.pointerEnabled?"pointerup":"MSPointerUp"],p(function(t){t.isTouchEvent()&&t.isPrimaryTouch()&&(this.lens.touchmovement=!1)}).jBindAsEvent(this),10),this.registerAnimateEvent(),this.option("zoomMode")&&(this.registerActivateEvent("click"===this.option("zoomOn")),this.registerDeactivateEvent("click"===this.option("zoomOn"))),this.node.jAddEvent("mousedown",function(t){t.stopDistribution()},10).jAddEvent("btnclick",p(function(t){this.node.jRaiseEvent("MouseEvent","click"),this.expanded&&this.expandBox.jCallEvent("btnclick",t)}).jBind(this),15),this.option("expand")?this.node.jAddEvent("tap btnclick",p(this.expand).jBindAsEvent(this),15):this.node.jAddEvent("tap btnclick",p(this.openLink).jBindAsEvent(this),15),1<this.additionalImages.length&&this.swipe(),!m.browser.mobile&&this.option("variableZoom")&&this.node.jAddEvent("mousescroll",this.changeZoomLevel.jBindAsEvent(this)),m.browser.mobile&&this.pinchToZoom(),p(window).jAddEvent(m.browser.mobile?"resize":"resize scroll",this.onResize),this.option("history")&&p(window).jAddEvent("popstate",this.onHistoryStateChange)},unregisterEvents:function(){this.node&&this.node.jRemoveEvent("mousescroll"),p(window).jRemoveEvent("resize scroll",this.onResize),this.option("history")&&p(window).jRemoveEvent("popstate",this.onHistoryStateChange),p(this.additionalImages).jEach(function(t){p(t.origin).jClearEvents()})},activate:function(t){var e,i,o,n,s=0,a=0;this.image.loaded()&&this.ready&&this.zoomBox.enabled&&!this.zoomBox.active&&!this.zoomBox.activating?t&&"pointermove"===t.type&&"touch"===t.pointerType||(this.option("zoomMode")||!this.option("expand")||this.expanded?(this.zoomBox.activating=!0,this.expanded&&"zoom"===this.zoomBox.mode&&(o=this.image.node.jGetRect(),this.expandStage.jAddClass("mz-zoom-in"),n=this.expandFigure.jGetRect(),a=(o.left+o.right)/2-(n.left+n.right)/2,s=(o.top+o.bottom)/2-(n.top+n.bottom)/2),this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-deactivating").jRemoveEvent("transitionend"),this.zoomBox.node.jAddClass("mz-activating"),this.node.jAddClass("mz-activating"),this.reflowZoom(),i="zoom"===this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode,!m.browser.features.transition||this.expanded&&"always"===this.option("expandZoomOn")?(this.zoomBox.node.jRemoveClass("mz-activating"),this.zoomBox.activating=!1,this.zoomBox.active=!0):"inner"===i?(n=this.image.node.jGetSize(),this.zoomBox.image.jSetCss({transform:"translate3d(0,"+s+"px, 0) scale("+n.width/this.zoomSize.width+", "+n.height/this.zoomSize.height+")"}).jGetSize(),this.zoomBox.image.jAddEvent("transitionend",p(function(){this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating mz-p-"+i),this.zoomBox.activating=!1,this.zoomBox.active=!0}).jBind(this)),this.zoomBox.node.jAddClass("mz-p-"+i).jGetSize(),m.browser.mobile||!m.browser.chrome||"chrome"!==m.browser.uaName&&"opera"!==m.browser.uaName||(this.zoomBox.activating=!1,this.zoomBox.active=!0)):(this.zoomBox.node.jAddEvent("transitionend",p(function(){this.zoomBox.node.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating mz-p-"+i)}).jBind(this)),this.zoomBox.node.jSetCss({transition:"none"}),this.zoomBox.node.jAddClass("mz-p-"+i).jGetSize(),this.zoomBox.node.jSetCss({transition:""}).jGetSize(),this.zoomBox.node.jRemoveClass("mz-p-"+i),this.zoomBox.activating=!1,this.zoomBox.active=!0),this.expanded||this.showHint(!0),t?(t.stop().stopQueue(),e=t.getClientXY(),"magnifier"===this.zoomBox.mode&&/tap/i.test(t.type)&&(e.y-=this.zoomBox.height/2+10),"inner"===i&&(/tap/i.test(t.type)||t.isTouchEvent())&&(this.lens.pos={x:0,y:0},e.x=-(e.x-this.boundaries.left-this.size.width/2)*(this.zoomSize.width/this.size.width),e.y=-(e.y-this.boundaries.top-this.size.height/2)*(this.zoomSize.height/this.size.height))):(e={x:this.boundaries.left+(this.boundaries.right-this.boundaries.left)/2,y:this.boundaries.top+(this.boundaries.bottom-this.boundaries.top)/2},m.browser.mobile&&this.expanded&&"always"===this.option("expandZoomOn")&&(this.lens.innertouch=!0,this.lens.pos={x:0,y:0},e.x=-(e.x-this.boundaries.left-this.size.width/2)*(this.zoomSize.width/this.size.width),e.y=-(e.y-this.boundaries.top-this.size.height/2)*(this.zoomSize.height/this.size.height))),this.node.jRemoveClass("mz-activating").jAddClass("mz-active"),e.x+=-a,e.y+=-s,this.lens.spos={x:0,y:0},this.lens.dx=0,this.lens.dy=0,this.animate(t,e,!0),C("onZoomIn",this.id)):this.zoomBox.active=!0):this.image.loaded()||this.initEvent||(t&&(this.initEvent=y(t),t.stopQueue()),this.image.load(this.setupZoom.jBind(this)),this.loadTimer||(this.loadTimer=p(this.showLoading).jBind(this).jDelay(400)))},deactivate:function(t,e){var i,o=0,n=this.zoomBox.active;this.initEvent=null,this.ready&&(t&&"pointerout"===t.type&&"touch"===t.pointerType||(clearTimeout(this.moveTimer),this.moveTimer=null,clearTimeout(this.activateTimer),this.activateTimer=null,this.zoomBox.activating=!1,!(this.zoomBox.active=!1)===e||this.expanded||n&&(m.browser.mobile&&!this.expanded&&"zoom"===this.zoomBox.mode?this.reflowZoom():this.showHint()),this.zoomBox.enabled&&(t&&t.stop(),this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-activating").jRemoveEvent("transitionend"),this.expanded&&(i=this.expandFigure.jGetRect(),"always"!==this.option("expandZoomOn")&&this.expandStage.jRemoveClass("mz-zoom-in"),this.image.node.jSetCss({"max-height":this.expandMaxHeight()}),(e=this.image.node.jGetRect()).left,e.right,i.left,i.right,o=(e.top+e.bottom)/2-(i.top+i.bottom)/2),i="zoom"===this.zoomBox.mode?this.zoomBox.position:this.zoomBox.mode,!m.browser.features.transition||!t||this.expanded&&"always"===this.option("expandZoomOn")?(this.zoomBox.hide(),this.node.jRemoveClass("mz-active")):"inner"===i?(this.zoomBox.image.jAddEvent("transitionend",p(function(){this.zoomBox.image.jRemoveEvent("transitionend"),this.node.jRemoveClass("mz-active"),setTimeout(p(function(){this.zoomBox.hide()}).jBind(this),32)}).jBind(this)),t=this.image.node.jGetSize(),this.zoomBox.node.jAddClass("mz-deactivating mz-p-"+i).jGetSize(),this.zoomBox.image.jSetCss({transform:"translate3d(0,"+o+"px,0) scale("+t.width/this.zoomSize.maxWidth+", "+t.height/this.zoomSize.maxHeight+")"})):(this.zoomBox.node.jAddEvent("transitionend",p(function(){this.zoomBox.hide(),this.node.jRemoveClass("mz-active")}).jBind(this)),this.zoomBox.node.jGetCss("opacity"),this.zoomBox.node.jAddClass("mz-deactivating mz-p-"+i),this.node.jRemoveClass("mz-active")),this.lens.dx=0,this.lens.dy=0,this.lens.spos={x:0,y:0},this.lens.hide(),n&&C("onZoomOut",this.id))))},animate:function(t,e,i){var o,n,s,a,h=e,r=0,d=0,e=!1;if(this.zoomBox.active||i){if(t){if(p(t).stopDefaults().stopDistribution(),t.isTouchEvent()&&!t.isPrimaryTouch())return;(e=/tap/i.test(t.type)||t.isTouchEvent())&&!this.lens.touchmovement&&(this.lens.touchmovement=e),h=h||t.getClientXY()}"preview"!==this.zoomBox.mode&&("zoom"===this.zoomBox.mode&&"inner"===this.zoomBox.position&&(t&&e||!t&&this.lens.innertouch)?(this.lens.innertouch=!0,o=this.lens.pos.x+(h.x-this.lens.spos.x),n=this.lens.pos.y+(h.y-this.lens.spos.y),this.lens.spos=h,s=-(r=Math.min(0,this.zoomBox.innerWidth-this.zoomSize.width)/2),a=-(d=Math.min(0,this.zoomBox.innerHeight-this.zoomSize.height)/2)):(this.lens.innertouch=!1,"magnifier"===this.zoomBox.mode&&(h.y=Math.max(this.boundaries.top,Math.min(h.y,this.boundaries.bottom)),h.x=Math.max(this.boundaries.left,Math.min(h.x,this.boundaries.right))),o=h.x-this.boundaries.left,n=h.y-this.boundaries.top,s=this.size.width-this.lens.width,a=this.size.height-this.lens.height,o-=this.lens.width/2,n-=this.lens.height/2),"magnifier"!==this.zoomBox.mode&&(o=Math.max(r,Math.min(o,s)),n=Math.max(d,Math.min(n,a))),this.lens.pos.x=o,this.lens.pos.y=n,"zoom"===this.zoomBox.mode&&(m.browser.features.transform?(this.lens.node.jSetCss({transform:"translate("+this.lens.pos.x+"px,"+this.lens.pos.y+"px)"}),this.lens.image.jSetCss({transform:"translate("+-(this.lens.pos.x+this.lens.border.x)+"px, "+-(this.lens.pos.y+this.lens.border.y)+"px)"})):(this.lens.node.jSetCss({top:this.lens.pos.y,left:this.lens.pos.x}),this.lens.image.jSetCss({top:-(this.lens.pos.y+this.lens.border.y),left:-(this.lens.pos.x+this.lens.border.x)}))),"magnifier"===this.zoomBox.mode&&(!this.lens.touchmovement||t&&"dbltap"===t.type||(h.y-=this.zoomBox.height/2+10),this.zoomBox.node.jSetCss({top:h.y-this.boundaries.top-this.zoomBox.height/2,left:h.x-this.boundaries.left-this.zoomBox.width/2})),this.moveTimer||(this.lens.dx=0,this.lens.dy=0,this.move(1)))}},move:function(t){var e,i,o;isFinite(t)||(t=this.lens.innertouch?this.lens.touchmovement?.4:.16:this.option("smoothing")?.2:this.lens.touchmovement?.4:.8),o=(this.lens.pos.x-this.lens.dx)*t,t=(this.lens.pos.y-this.lens.dy)*t,this.lens.dx+=o,this.lens.dy+=t,(!this.moveTimer||1e-6<Math.abs(o)||1e-6<Math.abs(t))&&(i=this.lens.innertouch?(e=this.lens.dx,this.lens.dy):(e=this.lens.dx*(this.zoomSize.width/this.size.width)-Math.max(0,this.zoomSize.width-this.zoomBox.innerWidth)/2,i=this.lens.dy*(this.zoomSize.height/this.size.height)-Math.max(0,this.zoomSize.height-this.zoomBox.innerHeight)/2,"magnifier"===this.zoomBox.mode&&(e=Math.round(e),i=Math.round(i)),e=-e,-i),o=this.zoomSize.width/this.zoomSize.maxWidth,t=this.zoomSize.height/this.zoomSize.maxHeight,this.zoomBox.image.jSetCss(m.browser.features.transform?{transform:x+e+"px,"+i+"px"+w+" scale("+o+","+t+")"}:{width:this.zoomSize.width,height:this.zoomSize.height,left:-(this.lens.dx*(this.zoomSize.width/this.size.width)+Math.min(0,this.zoomSize.width-this.zoomBox.innerWidth)/2),top:-(this.lens.dy*(this.zoomSize.height/this.size.height)+Math.min(0,this.zoomSize.height-this.zoomBox.innerHeight)/2)})),"magnifier"!==this.zoomBox.mode&&(this.moveTimer=setTimeout(this.moveBind,16))},swipe:function(){var e,i,o,n,s,a,h,r={},d=0,l={transition:m.browser.cssTransform+String.fromCharCode(32)+"300ms cubic-bezier(.18,.35,.58,1)"},t=p(function(t){if(this.ready&&!this.zoomBox.active)if("dragstart"===t.state)clearTimeout(this.activateTimer),this.activateTimer=null,d=0,r={x:t.x,y:t.y,ts:t.timeStamp},e=this.size.width,i=e/2,this.image.node.jRemoveEvent("transitionend"),this.image.node.jSetCssProp("transition",""),this.image.node.jSetCssProp("transform","translate3d(0, 0, 0)"),h=null;else if(n=t.x-r.x,s={x:0,y:0,z:0},null===h&&(h=Math.abs(t.x-r.x)<Math.abs(t.y-r.y)),!h){if(t.stop(),"dragend"===t.state)return d=0,a=null,h=t.timeStamp-r.ts,(Math.abs(n)>i||h<201&&30<Math.abs(n))&&(o=0<n?"backward":n<=0?"forward":"")&&("backward"==o?(a=this.getPrev(),d+=10*e):(a=this.getNext(),d-=10*e)),s.x=d,s.deg=s.x/e*-90,this.image.node.jAddEvent("transitionend",p(function(t){this.image.node.jRemoveEvent("transitionend"),this.image.node.jSetCssProp("transition",""),a&&(this.image.node.jSetCss({transform:"translate3d("+s.x+"px, 0px, 0px)"}),this.update(a,!0))}).jBind(this)),this.image.node.jSetCss(l),this.image.node.jSetCss({"transition-duration":s.x?"100ms":"300ms",opacity:1-.2*Math.abs(s.x/e),transform:"translate3d("+s.x+"px, 0px, 0px)"}),void(n=0);s.x=n,s.z=-50*Math.abs(s.x/i),s.deg=s.x/i*-60,this.image.node.jSetCss({opacity:1-.2*Math.abs(s.x/i),transform:"translate3d("+s.x+"px, 0px, "+s.z+"px)"})}}).jBind(this);this.node.jAddEvent("touchdrag",t)},pinchToZoom:function(){var n,s={width:0,height:0},a=!1,h=p(function(t,e,i){var o;(this.zoomBox.active||i)&&(o=m.detach(this.zoomSize),i=Math.max(n.width,Math.round(s.width*t)),t=(i=Math.min(i,this.zoomSize.maxWidth))/(this.zoomSize.maxWidth/this.zoomSize.maxHeight),this.zoomSize.width=Math.floor(i),this.zoomSize.height=Math.floor(t),this.lens.width=Math.ceil(this.zoomBox.innerWidth/(this.zoomSize.width/n.width)),this.lens.height=Math.ceil(this.zoomBox.innerHeight/(this.zoomSize.height/n.height)),this.lens.node.jSetCss({width:this.lens.width,height:this.lens.height}),m.extend(this.lens,this.lens.node.jGetSize()),clearTimeout(this.moveTimer),this.moveTimer=null,e.x=this.lens.spos.x*(this.zoomSize.width/o.width)+(e.x-this.boundaries.left-this.size.width/2)*(1-this.zoomSize.width/o.width),e.y=this.lens.spos.y*(this.zoomSize.height/o.height)+(e.y-this.boundaries.top-this.size.height/2)*(1-this.zoomSize.height/o.height),this.lens.spos={x:0,y:0},this.lens.pos={x:0,y:0},this.lens.innertouch=!0,this.animate(null,{x:e.x,y:e.y}),clearTimeout(this.moveTimer),this.moveTimer=null)}).jBind(this),t=p(function(t){if(a||"pinchstart"===t.state||t.cloned){t.stop();var e=p(window).jGetScroll(),i=!1,o={x:t.centerPoint.x-e.x,y:t.centerPoint.y-e.y};switch(t.state){case"pinchstart":this.unregisterAnimateEvent(),s=m.detach(this.zoomSize),n=this.expanded?this.image.node.jGetSize():this.size,clearTimeout(this.moveTimer),this.moveTimer=null,this.zoomBox.active&&(this.lens.spos=m.detach(this.lens.pos)),a=!0;break;case"pinchend":a=!1,this.zoomBox.active&&("always"!==this.option("expandZoomOn")&&this.zoomSize.width<=n.width&&this.zoomSize.height<=n.height?(a=!1,this.deactivate(null)):0<t.points.length&&(this.lens.spos={x:t.points[0].clientX,y:t.points[0].clientY})),this.registerAnimateEvent();break;case"pinchresize":break;case"pinchmove":if(!this.expanded||-1!==t.zoom||this.zoomBox.active&&"always"!==this.option("expandZoomOn")){if(!this.expanded||1!==t.zoom||"always"!==this.option("expandZoomOn"))if(this.option("expand")&&!this.expanded){if(1.1<t.scale)return a=!1,this.registerAnimateEvent(),void this.expand(t)}else{if(1===t.zoom&&!this.zoomBox.active){if(!this.image.loaded()||!this.ready||!this.zoomBox.enabled)return void(this.image.loaded()||this.initEvent||(t&&(this.initEvent=y(t),t.stopQueue()),this.image.load(this.setupZoom.jBind(this)),this.loadTimer||(this.loadTimer=p(this.showLoading).jBind(this).jDelay(400))));this.zoomBox.activating=!0,this.expanded&&"zoom"===this.zoomBox.mode&&this.expandStage.jAddClass("mz-zoom-in"),this.zoomBox.image.jRemoveEvent("transitionend"),this.zoomBox.node.jRemoveClass("mz-deactivating").jRemoveEvent("transitionend"),this.zoomBox.node.jAddClass("mz-activating"),this.node.jAddClass("mz-activating"),this.reflowZoom(),this.zoomSize.width=n.width,this.zoomSize.height=n.height,this.zoomBox.activating=!1,this.zoomBox.active=!0,s=m.detach(this.zoomSize),this.zoomBox.node.jRemoveClass("mz-activating"),this.node.jRemoveClass("mz-activating").jAddClass("mz-active"),this.lens.spos={x:0,y:0},this.lens.pos={x:0,y:0},i=!0,this.expanded||this.showHint(!0)}h(t.scale,o,i),i&&C("onZoomIn",this.id)}}else t.scale<.5&&this.close()}}}).jBind(this);this.node.jAddEvent("pinch",t)},setupButtons:function(){var i=document.createDocumentFragment();p(["prev","next","close"]).jEach(function(t){var e="mz-button";switch(this.buttons[t]=m.$new("button",{type:"button",title:this.option("text-btn-"+t)}).jAddClass(e).jAddClass(e+"-"+t),i.appendChild(this.buttons[t]),t){case"prev":this.buttons[t].jAddEvent("tap btnclick",function(t){t.stop(),this.update(this.getPrev())}.jBindAsEvent(this));break;case"next":this.buttons[t].jAddEvent("tap btnclick",function(t){t.stop(),this.update(this.getNext())}.jBindAsEvent(this));break;case"close":this.buttons[t].jAddEvent("tap btnclick",function(t){t.stop(),this.close()}.jBindAsEvent(this)).hide()}},this),this.toggleNavButtons(1<this.additionalImages.length),this.navControlsLayer=m.$new("div").jAddClass("mz-nav-controls").append(i).jAppendTo(this.node)},toggleNavButtons:function(t){t?(this.buttons.next.show(),this.buttons.prev.show()):(this.buttons.next.hide(),this.buttons.prev.hide())},setupExpandGallery:function(){var e,t;this.additionalImages.length?this.expandGallery=this.additionalImages:(e=this.placeholder.getAttribute("data-gallery"))&&(t=m.browser.features.query?m.$A(document.querySelectorAll('.MagicZoom[data-gallery="'+e+'"], .MagicZoomPlus[data-gallery="'+e+'"]')):m.$A(document.getElementsByTagName("A")).filter(function(t){return e===t.getAttribute("data-gallery")}),p(t).jEach(function(t){var e,i=j(t);i&&0<i.additionalImages.length||(i?((e=new S(i.image.small.url,i.image.zoom.url,i.image.caption,null,i.image.origin)).link=i.image.link,e.alt=i.image.alt):e=(new S).parseNode(t,i?i.originalTitle:null),(this.image.zoom.src.has(e.zoom.url)||this.image.zoom.url.has(e.zoom.url))&&(this.image.small.src.has(e.small.url)||this.image.small.url.has(e.small.url))&&(e=this.image),this.expandGallery.push(e))},this),this.primaryImage=this.image),this.expandedViewId||(this.expandedViewId=Math.floor(Math.random()*m.now())),1<this.expandGallery.length?(this.expandStage.jAddClass("with-thumbs"),this.expandNav=m.$new("div",{class:"mz-expand-thumbnails"}).jAppendTo(this.expandStage),this.expandThumbs=new i(this.expandNav),p(this.expandGallery).jEach(function(e){var i=p(function(t){this.setActiveThumb(e),this.update(e)}).jBind(this);e.selector=this.expandThumbs.addItem(m.$new("img",{src:e.getURL("small"),alt:e.alt}).jAddEvent("tap btnclick",function(t){t.stop()}).jAddEvent("tap "+("hover"===this.option("selectorTrigger")?"mouseover mouseout":"btnclick"),p(function(t,e){this.updateTimer&&clearTimeout(this.updateTimer),this.updateTimer=!1,"mouseover"===t.type?this.updateTimer=p(i).jDelay(e):"tap"!==t.type&&"btnclick"!==t.type||i()}).jBindAsEvent(this,60)))},this)):this.expandStage.jRemoveClass("with-thumbs"),this.toggleNavButtons(1<this.expandGallery.length),this.buttons.close.show()},destroyExpandGallery:function(){var t;if(this.expandThumbs&&(this.expandThumbs.stop(),this.expandThumbs=null),this.expandNav&&(this.expandNav.jRemove(),this.expandNav=null),this.toggleNavButtons(1<this.additionalImages.length),this.buttons.close.hide(),1<this.expandGallery.length&&!this.additionalImages.length)for(this.node.jRemoveEvent("touchdrag"),this.image.node.jRemove().getAttribute("style"),this.image.node.removeAttribute("style"),this.primaryImage.node.jAppendTo(this.node),this.setupZoom(this.primaryImage);t=this.expandGallery.pop();)t!==this.primaryImage&&(t.small.node&&(t.small.node.kill(),t.small.node=null),t.zoom.node&&(t.zoom.node.kill(),t.zoom.node=null),t=null);this.expandGallery=[]},close:function(){this.ready&&this.expanded&&("ios"===m.browser.platform&&"safari"===m.browser.uaName&&7===parseInt(m.browser.uaVersion)&&(clearInterval(z),z=null),p(document).jRemoveEvent("keydown",this.keyboardCallback),this.deactivate(null,!0),this.ready=!1,m.browser.fullScreen.capable&&m.browser.fullScreen.enabled()?m.browser.fullScreen.cancel():m.browser.features.transition?(this.node.jRemoveEvent("transitionend").jSetCss({transition:""}),this.node.jAddEvent("transitionend",this.onClose),m.browser.webkit&&setTimeout(p(function(){this.onClose()}).jBind(this),260),this.expandBg.jRemoveEvent("transitionend").jSetCss({transition:""}),this.expandBg.jSetCss({transition:"all 0.6s cubic-bezier(0.895, 0.030, 0.685, 0.220) 0.0s"}).jGetSize(),this.node.jSetCss({transition:"all .3s cubic-bezier(0.600, 0, 0.735, 0.045) 0s"}).jGetSize(),!1!==this.zoomBox.mode&&"always"===this.option("expandZoomOn")&&"magnifier"!==this.option("expandZoomMode")&&(this.image.node.jSetCss({"max-height":this.image.jGetSize("zoom").height}),this.image.node.jSetCss({"max-width":this.image.jGetSize("zoom").width})),this.expandBg.jSetCss({opacity:.4}),this.node.jSetCss({opacity:.01,transform:"scale(0.4)"})):this.onClose())},expand:function(t){var e;this.image.loaded()&&this.ready&&!this.expanded?(t&&t.stopQueue(),e=p(this.node).jFetch("cr"),this.hideHint(),this.hintRuns--,this.deactivate(null,!0),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),this.ready=!1,this.expandBox||(this.expandBox=m.$new("div").jAddClass("mz-expand").jAddClass(this.option("cssClass")).jSetCss({opacity:0}),this.expandStage=m.$new("div").jAddClass("mz-expand-stage").jAppendTo(this.expandBox),this.expandBox.jAddEvent("mousescroll touchstart dbltap",p(function(t){p(t).stop()})),this.option("closeOnClickOutside")&&this.expandBox.jAddEvent("tap btnclick",function(t){var e=t.jGetPageXY(),i=p("magnifier"===this.option("expandZoomMode")?this.zoomBox.node:this.zoomBox.image).jGetRect();if("always"!==this.option("expandZoomOn")&&i.top<=e.y&&e.y<=i.bottom&&i.left<=e.x&&e.x<=i.right)return t.stopQueue(),void this.deactivate(t);"always"!==this.option("expandZoomOn")&&this.node.hasChild(t.getOriginalTarget())||(t.stop(),this.close())}.jBindAsEvent(this)),this.keyboardCallback=p(function(t){var e;27!==t.keyCode&&37!==t.keyCode&&39!==t.keyCode||(p(t).stop(),27===t.keyCode?this.close():(e=37===t.keyCode?this.getPrev():this.getNext())&&this.update(e))}).jBindAsEvent(this),this.onExpand=p(function(){var o;if(this.node.jRemoveEvent("transitionend").jSetCss({transition:"",transform:"translate3d(0, 0, 0)"}),!this.expanded){if(this.expanded=!0,this.option("history"))try{var t="#mz-expanded-view-"+this.expandedViewId;window.location.hash!==t&&(history.state&&history.state.expandedView&&history.state.mzId?history.replaceState({expandedView:this.expandedViewId,mzId:this.id},document.title,t):history.pushState({expandedView:this.expandedViewId,mzId:this.id},document.title,t))}catch(t){}this.expandBox.jRemoveClass("mz-expand-opening").jSetCss({opacity:1}),this.zoomBox.setMode(this.option("expandZoomMode")),this.zoomSize=m.detach(this.zoomSizeOrigin),this.resizeCallback(),this.expandCaption&&this.image.caption&&this.expandCaption.jAddClass("mz-show"),"always"!==this.option("expandZoomOn")&&(this.registerActivateEvent(!0),this.registerDeactivateEvent(!0)),this.ready=!0,"always"===this.option("expandZoomOn")&&(!1!==this.zoomBox.mode&&this.zoomBox.enable(!0),m.browser.mobile&&this.mobileZoomHint&&(this.mobileZoomHint=!1),this.activate()),(m.browser.mobile||this.option("forceTouch"))&&this.mobileZoomHint&&this.zoomBox.enabled&&(this.showHint(!0,this.option("textClickZoomHint")),this.hintRuns!==1/0&&(this.mobileZoomHint=!1)),this.navControlsLayer.jRemoveClass("mz-hidden").jAddClass("mz-fade mz-visible"),this.expandNav&&this.expandNav.jRemoveClass("mz-hidden").jAddClass("mz-fade mz-visible"),this.expandThumbs&&(this.expandThumbs.run(),this.setActiveThumb(this.image)),e&&e.jAppendTo(this.expandBox,(Math.floor(101*Math.random())+1)%2?"top":"bottom"),1<this.expandGallery.length&&!this.additionalImages.length&&this.swipe(),p(document).jAddEvent("keydown",this.keyboardCallback),"ios"===m.browser.platform&&"safari"===m.browser.uaName&&7===parseInt(m.browser.uaVersion)&&(o=null,z=setInterval(function(){var t=90===window.orientation||-90===window.orientation,e=window.innerHeight,i=.85*(t?screen.availWidth:screen.availHeight);null!==o&&!1!==o||!(t&&e<i||!t&&e<i)?null!==o&&!0!==o||!(t&&i<e||!t&&i<e)||(o=!1,n()):(o=!0,n())},250)),C("onExpandOpen",this.id)}function n(){window.scrollTo(document.body.scrollLeft,document.body.scrollTop),window.dispatchEvent(new Event("resize"))}}).jBind(this),this.onClose=p(function(){this.node.jRemoveEvent("transitionend"),this.expanded&&(this.expanded&&(p(document).jRemoveEvent("keydown",this.keyboardCallback),this.deactivate(null,!0)),this.setSize(!0),this.destroyExpandGallery(),this.expanded=!1,this.option("history")&&window.location.hash==="#mz-expanded-view-"+this.expandedViewId&&history.back(),this.zoomBox.setMode(this.option("zoomMode")),this.node.replaceChild(this.image.getNode("small"),this.image.node),this.image.setCurNode("small"),p(this.image.node).jSetCss({width:"",height:"","max-width":Math.min(this.image.jGetSize("small").width),"max-height":Math.min(this.image.jGetSize("small").height)}),this.lens.image.src=this.image.getURL("small"),this.node.jSetCss({opacity:"",transition:""}),this.node.jSetCss({transform:"translate3d(0, 0, 0)"}),p(this.placeholder).replaceChild(this.node,this.stubNode),this.navControlsLayer.jRemoveClass("mz-expand-controls").jRemoveClass("mz-hidden").jAddClass("mz-fade mz-visible").jAppendTo(this.node),this.setSize(!0),this.expandCaption&&(this.expandCaption.jRemove(),this.expandCaption=null),this.unregisterActivateEvent(),this.unregisterDeactivateEvent(),"always"===this.option("zoomOn")?this.activate():!1!==this.option("zoomMode")&&(this.registerActivateEvent("click"===this.option("zoomOn")),this.registerDeactivateEvent("click"===this.option("zoomOn"))),this.showHint(),this.expandBg.jRemoveEvent("transitionend"),this.expandBox.jRemove(),this.expandBg.jRemove(),this.expandBg=null,a&&a.jRemove(),p(m.browser.getDoc()).jRemoveClass("mz-expanded-view-open"),this.ready=!0,m.browser.ieMode<10?this.resizeCallback():p(window).jRaiseEvent("UIEvent","resize"),C("onExpandClose",this.id))}).jBind(this),this.expandImageStage=m.$new("div",{class:"mz-image-stage"}).jAppendTo(this.expandStage),this.expandFigure=m.$new("figure").jAppendTo(this.expandImageStage),this.stubNode=this.node.cloneNode(!1)),this.navControlsLayer.jAddClass("mz-expand-controls").jAppendTo(this.expandImageStage),this.setupExpandGallery(),a&&a.jAppendTo(document.body),p(m.browser.getDoc()).jAddClass("mz-expanded-view-open"),p(document.body).jGetSize(),"fullscreen"===this.option("expand")?(this.prepareExpandedView(),m.browser.fullScreen.request(this.expandBox,{onEnter:p(function(){this.onExpand()}).jBind(this),onExit:this.onClose,fallback:p(function(){this.expandToWindow()}).jBind(this)})):setTimeout(p(function(){this.prepareExpandedView(),this.expandToWindow()}).jBind(this),96)):this.image.loaded()||this.initEvent||(t&&(this.initEvent=y(t),t.stopQueue(),"tap"===t.type&&t.events[1].stopQueue()),this.image.load(this.setupZoom.jBind(this)),this.loadTimer||(this.loadTimer=p(this.showLoading).jBind(this).jDelay(400)))},prepareExpandedView:function(){var t=m.$new("img",{srcset:this.image.getURL("zoom")+" "+this.image.getRatio("zoom")+"x",src:this.image.getURL("zoom"),alt:this.image.alt});this.expandBg=m.$new("div").jAddClass("mz-expand-bg").append(m.browser.features.cssFilters||m.browser.ieMode<10?t:new m.SVGImage(t).blur(20).getNode()).jAppendTo(this.expandBox),"always"===this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&this.expandStage.jAddClass("mz-always-zoom"+("zoom"===this.option("expandZoomMode")?" mz-zoom-in":"")).jGetSize(),t=p(this.node)[m.browser.ieMode<10?"jGetSize":"getBoundingClientRect"](),p(this.stubNode).jSetCss({width:t.width,height:t.height}),this.node.replaceChild(this.image.getNode("zoom"),this.image.node),this.image.setCurNode("zoom"),this.expandBox.jAppendTo(document.body),a&&this.expandBox.jSetCss({height:window.innerHeight,maxHeight:"100vh",top:Math.abs(a.getBoundingClientRect().top)}),this.expandMaxWidth=function(){var t=this.expandImageStage;return 50<p(this.expandFigure).jGetSize().width&&(t=this.expandFigure),function(){return"always"===this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&"magnifier"!==this.option("expandZoomMode")?1/0:Math.round(p(t).getInnerSize().width)}}.call(this),this.expandMaxHeight=function(){var t=this.expandImageStage;return 50<p(this.expandFigure).jGetSize().height&&(t=this.expandFigure),function(){return"always"===this.option("expandZoomOn")&&!1!==this.option("expandZoomMode")&&"magnifier"!==this.option("expandZoomMode")?1/0:Math.round(p(t).getInnerSize().height)}}.call(this),this.navControlsLayer.jRemoveClass("mz-fade mz-visible").jAddClass("mz-hidden"),this.expandNav&&this.expandNav.jRemoveClass("mz-fade mz-visible").jAddClass("mz-hidden"),this.option("expandCaption")&&(this.expandCaption=m.$new("figcaption",{class:"mz-caption"}).jAppendTo(this.expandImageStage),this.expandCaption&&this.image.caption&&(this.image.link?this.expandCaption.append(m.$new("a",{href:this.image.link}).jAddEvent("tap btnclick",this.openLink.jBind(this)).changeContent(this.image.caption)):this.expandCaption.changeContent(this.image.caption))),this.image.node.jSetCss({"max-height":Math.min(this.image.jGetSize("zoom").height,this.expandMaxHeight())}),this.image.node.jSetCss({"max-width":Math.min(this.image.jGetSize("zoom").width,this.expandMaxWidth())}),this.expandFigure.append(p(this.placeholder).replaceChild(this.stubNode,this.node))},expandToWindow:function(){this.node.jSetCss({transition:""}),this.node.jSetCss({transform:"scale(0.6)"}).jGetSize(),this.node.jSetCss({transition:m.browser.cssTransform+" 0.4s cubic-bezier(0.175, 0.885, 0.320, 1) 0s"}),m.browser.features.transition?(this.node.jAddEvent("transitionend",this.onExpand),!m.browser.chrome||"chrome"!==m.browser.uaName&&"opera"!==m.browser.uaName||setTimeout(p(function(){this.onExpand()}).jBind(this),500)):this.onExpand.jDelay(16,this),this.expandBox.jSetCss({opacity:1}),this.node.jSetCss({transform:"scale(1)"})},openLink:function(){this.image.link&&window.open(this.image.link,"_self")},getNext:function(){var t=(this.expanded?this.expandGallery:this.additionalImages).filter(function(t){return-1!==t.small.state||-1!==t.zoom.state}),e=t.length,i=p(t).indexOf(this.image)+1;return e<=1?null:t[e<=i?0:i]},getPrev:function(){var t=(this.expanded?this.expandGallery:this.additionalImages).filter(function(t){return-1!==t.small.state||-1!==t.zoom.state}),e=t.length,i=p(t).indexOf(this.image)-1;return e<=1?null:t[i<0?e-1:i]},imageByURL:function(e,i){return(this.additionalImages.filter(function(t){return(t.zoom.src.has(e)||t.zoom.url.has(e))&&(t.small.src.has(i)||t.small.url.has(i))})||[])[0]||(i&&e&&"string"===m.jTypeOf(i)&&"string"===m.jTypeOf(e)?new S(i,e):null)},imageByOrigin:function(e){return(this.additionalImages.filter(function(t){return t.origin===e})||[])[0]},imageByIndex:function(t){return this.additionalImages[t]}},o={version:"v5.3.7 (Plus) DEMO",start:function(t,e){var i=null,o=[];return m.$A(t?[p(t)]:m.$A(document.byClass("MagicZoom")).concat(m.$A(document.byClass("MagicZoomPlus")))).jEach(p(function(t){p(t)&&(j(t)||(i=new E(t,e),f&&!i.option("autostart")?(i.stop(),i=null):(g.push(i),o.push(i))))}).jBind(this)),t?o[0]:o},stop:function(t){var e,i;if(t)(i=j(t))&&(i=g.splice(g.indexOf(i),1))&&i[0].stop()&&delete i[0];else for(;e=g.length;)(i=g.splice(e-1,1))[0].stop(),delete i[0]},refresh:function(t){return this.stop(t),this.start(t)},update:function(t,e,i,o){var n,t=j(t);t&&(n="element"===m.jTypeOf(e)?t.imageByOrigin(e):t.imageByURL(e,i))&&t.update(n)},switchTo:function(t,e){var i,o=j(t);if(o){switch(m.jTypeOf(e)){case"element":i=o.imageByOrigin(e);break;case"number":i=o.imageByIndex(e)}i&&o.update(i)}},prev:function(t){(t=j(t))&&t.update(t.getPrev())},next:function(t){(t=j(t))&&t.update(t.getNext())},zoomIn:function(t){(t=j(t))&&t.activate()},zoomOut:function(t){(t=j(t))&&t.deactivate()},expand:function(t){(t=j(t))&&t.expand()},close:function(t){(t=j(t))&&t.close()},registerCallback:function(t,e){l[t]||(l[t]=[]),"function"===m.jTypeOf(e)&&l[t].push(e)},running:function(t){return!!j(t)}},p(document).jAddEvent("domready",function(){var t=window.mzOptions||{};b=b(),m.addCSS(".magic-hidden-wrapper, .magic-temporary-img",{display:"block !important","min-height":"0 !important","min-width":"0 !important","max-height":"none !important","max-width":"none !important",width:"10px !important",height:"10px !important",position:"absolute !important",top:"-10000px !important",left:"0 !important",overflow:"hidden !important","-webkit-transform":"none !important",transform:"none !important","-webkit-transition":"none !important",transition:"none !important"},"magiczoom-reset-css"),m.addCSS(".magic-temporary-img img, .magic-temporary-img picture",{display:"inline-block !important",border:"0 !important",padding:"0 !important","min-height":"0 !important","min-width":"0 !important","max-height":"none !important","max-width":"none !important","-webkit-transform":"none !important",transform:"none !important","-webkit-transition":"none !important",transition:"none !important"},"magiczoom-reset-css"),m.addCSS(".magic-temporary-img picture, .magic-temporary-img picture > img",{width:"auto !important",height:"auto !important"},"magiczoom-reset-css"),m.browser.androidBrowser&&m.addCSS(".mobile-magic .mz-expand .mz-expand-bg",{display:"none !important"},"magiczoom-reset-css"),!m.browser.androidBrowser||"chrome"===m.browser.uaName&&44!==m.browser.uaVersion||m.addCSS(".mobile-magic .mz-zoom-window.mz-magnifier, .mobile-magic .mz-zoom-window.mz-magnifier:before",{"border-radius":"0 !important"},"magiczoom-reset-css"),s=m.$new("div",{class:"magic-hidden-wrapper"}).jAppendTo(document.body),n=m.browser.mobile&&window.matchMedia&&window.matchMedia("(max-device-width: 767px), (max-device-height: 767px)").matches,m.browser.mobile&&m.extend(h,r),n&&"ios"===m.browser.platform&&(a=m.$new("div").jSetCss({position:"fixed",top:0,width:0,height:"100vh"}));for(var e=0;e<d.length;e++)t[d[e]]&&m.$F!==t[d[e]]&&o.registerCallback(d[e],t[d[e]]);o.start(),f=!1}),window.MagicZoomPlus=window.MagicZoomPlus||{},o}();