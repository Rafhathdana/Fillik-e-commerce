<head>
  <link rel="stylesheet" href="/user/vendor/magiczoomplus/magiczoomplus.css" />
  <script src="/user/vendor/magiczoomplus/magiczoomplus.js"></script>
  <link rel="stylesheet" type="text/css" href="/stylesheets/style.css" />
</head>
<div class="wrap-modal3 js-modal3 p-t-60 p-b-20">
  <div class="overlay-modal3 js-hide-modal3"></div>

  <div class="container">
    <div class="bg0 p-t-60 p-b-30 p-lr-15-lg how-pos3-parent">
      <button class="how-pos3 hov3 trans-04 js-hide-modal3">
        <img src="/images/icons/icon-close.png" alt="CLOSE" />
      </button>

      <div class="row">
        <div class="col-12 grid-margin">
          <div class="card">
            <div class="card-body">
              <h4 class="card-title">Add New Address</h4>
              <form id="address-form">
                <p class="card-description">Type where to Deliver</p>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Name</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="name"
                          name="name"
                          required
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label"
                        >Mobile Number</label
                      >
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="mobile"
                          name="mobile"
                          required
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">House Name</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="hname"
                          name="hname"
                          required
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Place</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="place"
                          name="place"
                          required
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Land Mark</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="landMark"
                          name="landMark"
                          required
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Post Office</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="postOffice"
                          name="postOffice"
                          required
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">City</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="city"
                          name="city"
                          required
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">District</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          class="form-control"
                          id="district"
                          name="district"
                          required
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">State</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          id="state"
                          name="district"
                          class="form-control"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Counrty</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          id="country"
                          name="country"
                          class="form-control"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row">
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label">Pin Code</label>
                      <div class="col-sm-9">
                        <input
                          type="text"
                          id="pinNumber"
                          name="pinNumber"
                          class="form-control"
                        />
                      </div>
                    </div>
                  </div>
                  <div class="col-md-6">
                    <div class="form-group row">
                      <label class="col-sm-3 col-form-label"
                        >Confirm Pin Code</label
                      >
                      <div class="col-sm-9">
                        <input
                          type="text"
                          id="confirmPinCode"
                          name="confirmPinCode"
                          class="form-control"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="row d-flex">
                  <div class="col-lg-12">
                    <div class="form-check d-flex">
                      <label
                        class="form-check-label ml-4"
                        style="color: rgba(0, 0, 0, 0.92); display: flex"
                      >
                        <input
                          type="checkbox"
                          class="form-check-input"
                          name="termsCheckbox"
                          id="termsCheckbox"
                        />
                        I agree to all Terms & Conditions
                      </label>
                    </div>
                  </div>
                </div>
                <div class="row justify-content-center">
                  <button
                    type="button"
                    class="btn btn-secondary btn-rounded btn-fw"
                    onclick="addAddress(); this.disabled = true; this.innerHTML = 'Processing...'; setTimeout(function() { this.disabled = false; this.innerHTML = 'Add Address'; }, 5000);"
                  >
                    Add Address
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>

<script>
  function addAddress() {
    var name = document.querySelector("#name").value;
    var mobile = document.querySelector("#mobile").value;
    var hname = document.querySelector("#hname").value;
    var place = document.querySelector("#place").value;
    var landMark = document.querySelector("#landMark").value;
    var postOffice = document.querySelector("#postOffice").value;
    var city = document.querySelector("#city").value;
    var district = document.querySelector("#district").value;
    var state = document.querySelector("#state").value;
    var country = document.querySelector("#country").value;
    var pinNumber = parseInt(document.querySelector("#pinNumber").value);
    var confirmPinCode = parseInt(
      document.querySelector("#confirmPinCode").value
    );
    var termsCheckbox = document.querySelector("#termsCheckbox");
    console.log(pinNumber);
    // Check that all required fields are filled out
    if (
      !name ||
      !mobile ||
      !hname ||
      !place ||
      !postOffice ||
      !city ||
      !landMark ||
      !district ||
      !state ||
      !country ||
      !pinNumber ||
      !confirmPinCode
    ) {
      swal("Please fill out all required fields.");
      console.log(
        name,
        mobile,
        hname,
        landMark,
        place,
        postOffice,
        city,
        district,
        state,
        country,
        pinNumber,
        confirmPinCode
      );
      return;
    }

    // Check that the mobile number is valid
    if (!/^(\+\d{1,3}[- ]?)?\d{10}$/.test(mobile)) {
      swal("Please enter a valid mobile number.");
      return;
    }

    // Check that the pin code is valid and matches the confirmed pin code

    if (pinNumber !== confirmPinCode) {
      console.log(pinNumber, confirmPinCode);
      swal("The pin codes you entered do not match.");
      return;
    }

    // Check that the terms checkbox is checked
    if (!termsCheckbox.checked) {
      swal("Please accept the terms and conditions.");
      return;
    }

    fetch("/addAddress", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({
        name: name,
        mobile: mobile,
        houseName: hname,
        place: place,
        landMark: landMark,
        postOffice: postOffice,
        city: city,
        district: district,
        state: state,
        country: country,
        pinCode: pinNumber,
      }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.success) {
          swal("done");
        } else {
          swal("error");
        }
      })
      .catch((error) => {
        swal("Error adding product to cart: " + error);
      });
  }
</script>
<script>
  $(document).ready(function () {
    $.validator.addMethod(
      "noSpecialChars",
      function (value, element) {
        return this.optional(element) || /^(?!\s)[a-zA-Z ]+$/.test(value);
      },
      "Special characters and spaces are not allowed"
    );
    $.validator.addMethod(
      "number",
      function (value, element) {
        return this.optional(element) || /^(?!0)[0-9]+$/.test(value);
      },
      "numbers only allowed"
    );
    $("#address-form").validate({
      rules: {
        name: {
          required: true,
          minlength: 3,
          noSpecialChars: true,
        },
        mobile: {
          required: true,
          maxlength: 10,
          minlength: 10,
          number: true,
        },
        hname: {
          required: true,
        },
        place: {
          required: true,
        },
        city: {
          required: true,
        },
        district: {
          required: true,
        },
        state: {
          required: true,
        },
        country: {
          required: true,
        },
        pinNumber: {
          required: true,
          maxlength: 6,
          minlength: 6,
          number: true,
        },
        confirmPinCode: {
          required: true,
          equalTo: "#pinNumber",
        },
        termsCheckbox: {
          required: true,
        },
      },
      messages: {
        name: {
          required: "Please enter your full name",
          minlength: "Your name must be at least 3 characters long",
          noSpecialChars: "Special characters and spaces are not allowed",
        },
        mobile: {
          required: "Please enter Mobile Number",
          minlength: "10 digit indian number should be there",
          maxlength: "maximum 10 digit allowed in indian number",
          number: "only numbers allowed",
        },
        hname: {
          required: "Please enter your house name",
        },
        place: {
          required: "Please enter your place",
        },
        city: {
          required: "Please enter your city",
        },
        district: {
          required: "Please enter your district",
        },
        state: {
          required: "Please enter your state",
        },
        country: {
          required: "Please enter your country",
        },
        pinCode: {
          minlength: "6 digit indian pin number should be there",
          maxlength: "maximum 6 digit in  indian pin number ",
          number: "only numbers allowed",
        },
        ConfirmPInCode: {
          required: "Please confirm your pin code",
          equalTo: "Pin code does not match",
        },
        termsCheckbox: {
          required: "Please agree to the Terms & Conditions",
        },
      },
      highlight: function (element) {
        $(element).closest(".form-floating").addClass("is-invalid");
      },
      unhighlight: function (element) {
        $(element).closest(".form-floating").removeClass("is-invalid");
      },
      errorElement: "div",
      errorClass: "invalid-feedback",
      errorPlacement: function (error, element) {
        if (element.parent(".input-group").length) {
          error.insertAfter(element.parent());
        } else {
          error.insertAfter(element);
        }
      },
    });
  });
</script>
